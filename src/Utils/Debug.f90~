!*****************************************
! project: MHDG
! file: debug.f90
! date: 01/02/2017
! Collection of debugging routines
!*****************************************
MODULE debug

USE globals
USE Printutils
  IMPLICIT NONE
  
  CONTAINS
  
  SUBROUTINE print_matrices_tex()
   
  write(6,*) "Saving elemental matrices"  
     call saveArray(elMat%M, 'M')
     call saveArray(elMat%Cv,'Cv')
     call saveArray(elMat%H, 'H')
     call saveMatrix(elMat%Hdir, 'Hdir')
     call saveArray(elMat%D, 'D')
     call saveArray(elMat%E,'E')
     call saveMatrix(elMat%Edir,'Edir')
     call saveMatrix(elMat%S,'S')
     call saveArray(elMat%UU,'UU')
     call saveMatrix(elMat%U0,'U0')
     call saveArray(elMat%Hf,'Hf')
     call saveArray(elMat%Df,'Df')
     call saveArray(elMat%Ef,'Ef')
     call saveMatrix(elMat%fH,'fH')  
#ifdef NGAMMA
     call saveArray(elMat%B, 'B')
     call saveArray(elMat%C, 'C')
     call saveMatrix(elMat%Cdir, 'Cdir')
     call saveArray(elMat%P, 'P')
     call saveArray(elMat%Q, 'Q')
     call saveArray(elMat%iL, 'iL')
     call saveArray(elMat%Lf, 'Lf')
     call saveArray(elMat%Qf, 'Qf')
     call saveArray(elMat%LL,'LL')
     call saveMatrix(elMat%L0,'L0')     
#endif  
  END SUBROUTINE print_matrices_tex
  
  
 
 
  SUBROUTINE print_elmat_tex(K,f,iel)
  REAL, INTENT(IN)     :: K(:,:), f(:)
  INTEGER,INTENT(IN)   :: iel
  CHARACTER(LEN = 10)  :: num
  
  WRITE(num,"(I10)") iel
  CALL  saveMatrix(K,"K_" // ADJUSTL(num) )
  CALL  saveVector(f,"f_" // ADJUSTL(num) )
  
  END SUBROUTINE print_elmat_tex
  
  
   
END MODULE debug
