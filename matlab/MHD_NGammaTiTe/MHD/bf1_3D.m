% bf1_3D

function f = bf1_3D(X,t)
global testcase Mesh diff_n diff_u diff_ei diff_ee diff_pari diff_pare tie neq  epn pcourr
global Mref
D = diff_n;
mu = diff_u;
csii = diff_ei;
csie = diff_ee;
kpari = diff_pari;
kpare = diff_pare;

a = testcase.wavex;
a = 2*pi*a;
N2d = size(X,1);
N1d = size(t,1);

% allocation
f = zeros(N2d*N1d,neq);

% assign
x = X(:,1);
y = X(:,2);


xmax = Mesh.maxx;
xmin = Mesh.minx;
ymax = Mesh.maxy;
ymin = Mesh.miny;
xm = 0.5*(xmax+xmin);
ym = 0.5*(ymax+ymin);

for i=1:N2d
    for j=1:N1d
        xx = x(i);
        yy = y(i);
        ind = (j-1)*N2d+i;
        
        cx = cos(a*xx);
        cy = cos(a*yy);
        sx = sin(a*xx);
        sy = sin(a*yy);
        cx2 = cx^2;
        cy2 = cy^2;
        sx2 = sx^2;
        sy2 = sy^2;
        r = ((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2);
        r2 = ((xm - xx)^2 + (ym - yy)^2 + 1)^(3/2);
        
        f(ind,1) =  (2*D*a^2*sx*sy-2*a*xm*cx*sy*r+2*a*xx*cx*sy*r+2*a*ym*cy*sx*r-2*a*yy*cy*sx*r+D*a^2*xm^2*sx*sy+D*a^2*xx^2*sx*sy+D*a^2*ym^2*sx*sy+D*a^2*yy^2*sx*sy+D*a*xm*cx*sy-D*a*xx*cx*sy+D*a*ym*cy*sx-D*a*yy*cy*sx+a*xm*cx*cy2*sx*r-a*xx*cx*cy2*sx*r-a*ym*cx2*cy*sy*r+a*yy*cx2*cy*sy*r-a*xm*cx*sx*sy2*r+a*xx*cx*sx*sy2*r+a*ym*cy*sx2*sy*r-a*yy*cy*sx2*sy*r-2*D*a^2*xm*ym*cx*cy+2*D*a^2*xx*ym*cx*cy+2*D*a^2*xm*yy*cx*cy-2*D*a^2*xx*yy*cx*cy-2*D*a^2*xm*xx*sx*sy-2*D*a^2*ym*yy*sx*sy)/((xm-xx)^2+(ym-yy)^2+1);
        f(ind,2) =  (a*(60*xm*cy*sx*r-60*xx*cy*sx*r-60*ym*cx*sy*r+60*yy*cx*sy*r+4*xm*sx*sy*r-4*xx*sx*sy*r+4*ym*sx*sy*r-4*yy*sx*sy*r+12*a*mu*cx*cy-6*mu*xm*cy*sx+6*mu*xx*cy*sx-6*mu*ym*cx*sy+6*mu*yy*cx*sy-2*xm*cy2*sx2*r+2*xx*cy2*sx2*r-2*ym*cx2*sy2*r+2*yy*cx2*sy2*r+2*xm*sx2*sy2*r-2*xx*sx2*sy2*r+2*ym*sx2*sy2*r-2*yy*sx2*sy2*r+4*xm*cx*cy*r-4*xx*cx*cy*r+4*ym*cx*cy*r-4*yy*cx*cy*r+6*a*mu*xm^2*cx*cy+6*a*mu*xx^2*cx*cy+6*a*mu*ym^2*cx*cy+6*a*mu*yy^2*cx*cy+2*xm*cx2*cy^3*sx*r-2*xx*cx2*cy^3*sx*r-2*ym*cx^3*cy2*sy*r+2*yy*cx^3*cy2*sy*r+3*mu*ym*cx*cy2*sx+3*mu*xm*cx2*cy*sy-3*mu*xx*cx2*cy*sy-3*mu*yy*cx*cy2*sx-3*mu*ym*cx*sx*sy2-3*mu*xm*cy*sx2*sy+3*mu*xx*cy*sx2*sy+3*mu*yy*cx*sx*sy2+8*ym*cx*cy2*sx*r-8*xm*cx2*cy*sy*r+8*xx*cx2*cy*sy*r-8*yy*cx*cy2*sx*r-4*xm*cx2*cy*sx*sy2*r+4*xx*cx2*cy*sx*sy2*r+4*ym*cx*cy2*sx2*sy*r-4*yy*cx*cy2*sx2*sy*r-6*a*mu*xm*ym*cx2*cy2+6*a*mu*xx*ym*cx2*cy2+6*a*mu*xm*yy*cx2*cy2-6*a*mu*xx*yy*cx2*cy2+6*a*mu*xm*ym*cx2*sy2+6*a*mu*xm*ym*cy2*sx2-6*a*mu*xx*ym*cx2*sy2-6*a*mu*xx*ym*cy2*sx2-6*a*mu*xm*yy*cx2*sy2-6*a*mu*xm*yy*cy2*sx2+6*a*mu*xx*yy*cx2*sy2+6*a*mu*xx*yy*cy2*sx2-6*a*mu*xm*ym*sx2*sy2+6*a*mu*xx*ym*sx2*sy2+6*a*mu*xm*yy*sx2*sy2-6*a*mu*xx*yy*sx2*sy2+4*xm*cx*cy*sx*sy*r-4*xx*cx*cy*sx*sy*r+4*ym*cx*cy*sx*sy*r-4*yy*cx*cy*sx*sy*r-12*a*mu*xm*xx*cx*cy-12*a*mu*ym*yy*cx*cy-12*a*mu*xm*ym*sx*sy+12*a*mu*xx*ym*sx*sy+12*a*mu*xm*yy*sx*sy-12*a*mu*xx*yy*sx*sy+24*a*mu*cx*cy*sx*sy+12*a*mu*xm^2*cx*cy*sx*sy+12*a*mu*xx^2*cx*cy*sx*sy+12*a*mu*ym^2*cx*cy*sx*sy+12*a*mu*yy^2*cx*cy*sx*sy-24*a*mu*xm*xx*cx*cy*sx*sy-24*a*mu*ym*yy*cx*cy*sx*sy))/(3*(xm^2-2*ym*yy-2*xm*xx+xx^2+ym^2+yy^2+1));
        f(ind,3) =  (csii*(a*xx-a*xm+3*a^2*sin(2*a*xx)+2*a*xm*cx2-2*a*xx*cx2+a*xm*cy2-a*xx*cy2+4*a^2*cx*sy+40*a^2*sx*sy+2*a^2*xm^2*sin(2*a*xx)+2*a^2*xx^2*sin(2*a*xx)+a^2*ym^2*sin(2*a*xx)+a^2*yy^2*sin(2*a*xx)-2*a*xm*cx2*cy2+2*a*xx*cx2*cy2+2*a^2*xm^2*cx*sy+2*a^2*xx^2*cx*sy+2*a^2*ym^2*cx*sy+2*a^2*yy^2*cx*sy+20*a^2*xm^2*sx*sy+20*a^2*xx^2*sx*sy+20*a^2*ym^2*sx*sy+20*a^2*yy^2*sx*sy-8*a^2*cx*cy2*sx+2*a*ym*cx*cy-2*a*yy*cx*cy+20*a*xm*cx*sy-20*a*xx*cx*sy+20*a*ym*cy*sx-20*a*yy*cy*sx-2*a*xm*sx*sy+2*a*xx*sx*sy-4*a^2*xm*xx*sin(2*a*xx)+2*a^2*xm*ym*sin(2*a*yy)-2*a^2*xx*ym*sin(2*a*yy)-2*a^2*ym*yy*sin(2*a*xx)-2*a^2*xm*yy*sin(2*a*yy)+2*a^2*xx*yy*sin(2*a*yy)-4*a^2*xm^2*cx*cy2*sx-4*a^2*xx^2*cx*cy2*sx-4*a^2*ym^2*cx*cy2*sx-4*a^2*yy^2*cx*cy2*sx-40*a^2*xm*ym*cx*cy+40*a^2*xx*ym*cx*cy+40*a^2*xm*yy*cx*cy-40*a^2*xx*yy*cx*cy-4*a^2*xm*xx*cx*sy+4*a^2*xm*ym*cy*sx-4*a^2*xx*ym*cy*sx-4*a^2*xm*yy*cy*sx+4*a^2*xx*yy*cy*sx-4*a^2*ym*yy*cx*sy-40*a^2*xm*xx*sx*sy-40*a^2*ym*yy*sx*sy+8*a^2*xm*xx*cx*cy2*sx-8*a^2*xm*ym*cx2*cy*sy+8*a^2*xx*ym*cx2*cy*sy+8*a^2*ym*yy*cx*cy2*sx+8*a^2*xm*yy*cx2*cy*sy-8*a^2*xx*yy*cx2*cy*sy+2*a*ym*cx*cy*sx*sy-2*a*yy*cx*cy*sx*sy))/(xm^2-2*ym*yy-2*xm*xx+xx^2+ym^2+yy^2+1)-(2*3^(1-epn)*Mref*a*kpari*xx*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a*kpari*xm*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*xm^2*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*xx^2*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*ym^2*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*yy^2*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a^2*kpari*xm^2*cx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a^2*kpari*xx^2*cx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a^2*kpari*ym^2*cx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a^2*kpari*yy^2*cx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*xm^2*cx2*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*xx^2*cx2*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*ym^2*cy2*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a^2*kpari*yy^2*cy2*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn+4*3^(1-epn)*a^2*epn*kpari*xm^2*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+...
            4*3^(1-epn)*a^2*epn*kpari*xx^2*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+2*3^(1-epn)*Mref*a*kpari*ym*cx*cy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a*kpari*yy*cx*cy*((2*cx*sy-cx2*cy2+40)/Mref)^epn+4*3^(1-epn)*a^2*epn*kpari*ym^2*sx2*sy2*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+4*3^(1-epn)*a^2*epn*kpari*yy^2*sx2*sy2*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-8*3^(1-epn)*a^2*epn*kpari*ym*yy*sx2*sy2*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-4*3^(1-epn)*Mref*a^2*kpari*xm*xx*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^epn-4*3^(1-epn)*Mref*a^2*kpari*ym*yy*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^epn+8*3^(1-epn)*a^2*epn*kpari*xm^2*cx^3*cy2*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*a^2*epn*kpari*xx^2*cx^3*cy2*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+4*3^(1-epn)*Mref*a^2*kpari*xm*xx*cx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn+4*3^(1-epn)*Mref*a^2*kpari*xm*ym*cy*sx*((2*cx*sy-cx2*cy2+40)/Mref)^epn-4*3^(1-epn)*Mref*a^2*kpari*xx*ym*cy*sx*((2*cx*sy-cx2*cy2+40)/Mref)^epn-4*3^(1-epn)*Mref*a^2*kpari*xm*yy*cy*sx*((2*cx*sy-cx2*cy2+40)/Mref)^epn+4*3^(1-epn)*Mref*a^2*kpari*xx*yy*cy*sx*((2*cx*sy-cx2*cy2+40)/Mref)^epn+4*3^(1-epn)*Mref*a^2*kpari*ym*yy*cx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-4*3^(1-epn)*Mref*a^2*kpari*xm*xx*cx2*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn-4*3^(1-epn)*Mref*a^2*kpari*ym*yy*cy2*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a*kpari*xm*cx*cy2*sx*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a*kpari*xx*cx*cy2*sx*((2*cx*sy-cx2*cy2+40)/Mref)^epn+2*3^(1-epn)*Mref*a*kpari*ym*cx2*cy*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-2*3^(1-epn)*Mref*a*kpari*yy*cx2*cy*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-8*3^(1-epn)*a^2*epn*kpari*xm*xx*cx2*cy2*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-8*3^(1-epn)*a^2*epn*kpari*xm*ym*cx2*cy^3*sx*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*a^2*epn*kpari*xx*ym*cx2*cy^3*sx*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-16*3^(1-epn)*a^2*epn*kpari*xm*xx*cx^3*cy2*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*a^2*epn*kpari*xm*yy*cx2*cy^3*sx*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-8*3^(1-epn)*a^2*epn*kpari*xx*yy*cx2*cy^3*sx*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*Mref*a^2*kpari*xm*ym*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-8*3^(1-epn)*Mref*a^2*kpari*xx*ym*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-8*3^(1-epn)*Mref*a^2*kpari*xm*yy*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn+8*3^(1-epn)*Mref*a^2*kpari*xx*yy*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^epn-8*3^(1-epn)*a^2*epn*kpari*xm*ym*cx^3*cy^3*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+...
            8*3^(1-epn)*a^2*epn*kpari*xx*ym*cx^3*cy^3*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*a^2*epn*kpari*xm*yy*cx^3*cy^3*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-8*3^(1-epn)*a^2*epn*kpari*xx*yy*cx^3*cy^3*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*a^2*epn*kpari*xm*ym*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-8*3^(1-epn)*a^2*epn*kpari*xx*ym*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-8*3^(1-epn)*a^2*epn*kpari*xm*yy*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)+8*3^(1-epn)*a^2*epn*kpari*xx*yy*cx*cy*sx*sy*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)-(4*3^(1-epn)*Mref*a^2*epn*kpari*ym^2*cx2*cy^4*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)-(4*3^(1-epn)*Mref*a^2*epn*kpari*xm^2*cx^4*cy2*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)-(4*3^(1-epn)*Mref*a^2*epn*kpari*xx^2*cx^4*cy2*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)-(4*3^(1-epn)*Mref*a^2*epn*kpari*yy^2*cx2*cy^4*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)+(8*3^(1-epn)*Mref*a^2*epn*kpari*ym^2*cx*cy2*sy*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)+(8*3^(1-epn)*Mref*a^2*epn*kpari*yy^2*cx*cy2*sy*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)+(8*3^(1-epn)*Mref*a^2*epn*kpari*xm*xx*cx^4*cy2*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)+(8*3^(1-epn)*Mref*a^2*epn*kpari*ym*yy*cx2*cy^4*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)-(8*3^(1-epn)*Mref*a^2*epn*kpari*xm*ym*cx2*cy*sx*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)+(8*3^(1-epn)*Mref*a^2*epn*kpari*xx*ym*cx2*cy*sx*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)+(8*3^(1-epn)*Mref*a^2*epn*kpari*xm*yy*cx2*cy*sx*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)-(8*3^(1-epn)*Mref*a^2*epn*kpari*xx*yy*cx2*cy*sx*(cy2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40)-(16*3^(1-epn)*Mref*a^2*epn*kpari*ym*yy*cx*cy2*sy*(cx2-1)*((2*cx*sy-cx2*cy2+40)/Mref)^epn)/(2*cx*sy-cx2*cy2+40))/(9*Mref^2*((xm-xx)^2+(ym-yy)^2+1))+Mref*pcourr*cx*cy*((2*a*sx*(xm-xx)*(10*cy+sx+2*sy-2*cy2*sx))/(3*Mref*r)+(4*a*cx*(ym-yy)*(cy-5*sy+cy*sx*sy))/(3*Mref*r))-(a*cx*cy*(ym-yy)*(5*cx2*sy2-5*sx2*sy2+100*cx*sy-10*sx*sy-cx^3*cy2*sy+4*cx*cy2*sx+2*cx*cy2*sx2*sy))/(3*r)+(a*cx*cy2*(xm-xx)*(10*cx+100*sx+2*cx2*sx+4*cx2*sy-3*cx2*cy2*sx+10*cx*sx*sy))/(3*r)+(3^(1/2)*(sx*sy+2)^2*(2*cx*sy-cx2*cy2+2*cy*sx+20))/(2*tie*(cy*sx-10)*(-(2*cy*sx-20)/Mref)^(1/2))-(a*cx*sy*(sx*sy+2)*(xm-xx)*(5*cx*sy-cx2*cy2+100))/(3*r)+(a*cy*sx*(sx*sy+2)*(ym-yy)*(5*cx*sy-cx2*cy2+100))/(3*r)-(cx*cy*(2*xm-2*xx)*(sx*sy+2)*(ym-yy)*(5*cx*sy-cx2*cy2+100))/(6*r2)+(cx*cy*(2*ym-2*yy)*(sx*sy+2)*(xm-xx)*(5*cx*sy-cx2*cy2+100))/(6*r2);
        f(ind,4) =  (csie*(a*ym-a*yy-3*a^2*sin(2*a*yy)-a*ym*cx2+a*yy*cx2-2*a*ym*cy2+2*a*yy*cy2-4*a^2*cy*sx+20*a^2*sx*sy-a^2*xm^2*sin(2*a*yy)-a^2*xx^2*sin(2*a*yy)-2*a^2*ym^2*sin(2*a*yy)-2*a^2*yy^2*sin(2*a*yy)+2*a*ym*cx2*cy2-2*a*yy*cx2*cy2-2*a^2*xm^2*cy*sx-2*a^2*xx^2*cy*sx-2*a^2*ym^2*cy*sx-2*a^2*yy^2*cy*sx+10*a^2*xm^2*sx*sy+10*a^2*xx^2*sx*sy+10*a^2*ym^2*sx*sy+10*a^2*yy^2*sx*sy+8*a^2*cx2*cy*sy-2*a*xm*cx*cy+2*a*xx*cx*cy+10*a*xm*cx*sy-10*a*xx*cx*sy+10*a*ym*cy*sx-10*a*yy*cy*sx+2*a*ym*sx*sy-2*a*yy*sx*sy-2*a^2*xm*ym*sin(2*a*xx)+2*a^2*xx*ym*sin(2*a*xx)+2*a^2*xm*xx*sin(2*a*yy)+2*a^2*xm*yy*sin(2*a*xx)-2*a^2*xx*yy*sin(2*a*xx)+4*a^2*ym*yy*sin(2*a*yy)+4*a^2*xm^2*cx2*cy*sy+4*a^2*xx^2*cx2*cy*sy+4*a^2*ym^2*cx2*cy*sy+4*a^2*yy^2*cx2*cy*sy-20*a^2*xm*ym*cx*cy+20*a^2*xx*ym*cx*cy+20*a^2*xm*yy*cx*cy-20*a^2*xx*yy*cx*cy+4*a^2*xm*xx*cy*sx-4*a^2*xm*ym*cx*sy+4*a^2*xx*ym*cx*sy+4*a^2*xm*yy*cx*sy-4*a^2*xx*yy*cx*sy+4*a^2*ym*yy*cy*sx-20*a^2*xm*xx*sx*sy-20*a^2*ym*yy*sx*sy+8*a^2*xm*ym*cx*cy2*sx-8*a^2*xx*ym*cx*cy2*sx-8*a^2*xm*xx*cx2*cy*sy-8*a^2*xm*yy*cx*cy2*sx+8*a^2*xx*yy*cx*cy2*sx-8*a^2*ym*yy*cx2*cy*sy-2*a*xm*cx*cy*sx*sy+2*a*xx*cx*cy*sx*sy))/(xm^2-2*ym*yy-2*xm*xx+xx^2+ym^2+yy^2+1)-Mref*pcourr*cx*cy*((2*a*sx*(xm-xx)*(10*cy+sx+2*sy-2*cy2*sx))/(3*Mref*r)+(4*a*cx*(ym-yy)*(cy-5*sy+cy*sx*sy))/(3*Mref*r))+(10*a*cx2*cy*(ym-yy)*(cy-5*sy+cy*sx*sy))/(3*r)-(3^(1/2)*(sx*sy+2)^2*(2*cx*sy-cx2*cy2+2*cy*sx+20))/(2*tie*(cy*sx-10)*(-(2*cy*sx-20)/Mref)^(1/2))+(5*a*cx*cy*sx*(xm-xx)*(10*cy+sx+2*sy-2*cy2*sx))/(3*r)+(5*cx*cy*(cy*sx-10)*(2*xm-2*xx)*(sx*sy+2)*(ym-yy))/(6*r2)-(5*cx*cy*(cy*sx-10)*(2*ym-2*yy)*(sx*sy+2)*(xm-xx))/(6*r2)+(5*a*cx*sy*(cy*sx-10)*(sx*sy+2)*(xm-xx))/(3*r)-(5*a*cy*sx*(cy*sx-10)*(sx*sy+2)*(ym-yy))/(3*r)+(2/3^(epn+1)*a*kpare*(-(2*cy*sx-20)/Mref)^epn*(10*xx*cx*cy-10*xm*cx*cy+10*ym*sx*sy-10*yy*sx*sy+xm*cx*cy2*sx-xx*cx*cy2*sx-ym*cy*sx2*sy+yy*cy*sx2*sy-a*xm^2*cy2*sx2-a*xx^2*cy2*sx2-a*ym^2*cy2*sx2-a*yy^2*cy2*sx2+10*a*xm^2*cy*sx+10*a*xx^2*cy*sx+10*a*ym^2*cy*sx+10*a*yy^2*cy*sx+a*epn*xm^2*sx2*sy2+a*epn*xx^2*sx2*sy2+2*a*xm*xx*cy2*sx2+2*a*ym*yy*cy2*sx2+a*epn*ym^2*cx2*cy2+a*epn*yy^2*cx2*cy2-20*a*xm*xx*cy*sx-20*a*xm*ym*cx*sy+20*a*xx*ym*cx*sy+20*a*xm*yy*cx*sy-20*a*xx*yy*cx*sy-20*a*ym*yy*cy*sx-2*a*epn*ym*yy*cx2*cy2-2*a*epn*xm*xx*sx2*sy2+2*a*xm*ym*cx*cy*sx*sy-2*a*xx*ym*cx*cy*sx*sy-2*a*xm*yy*cx*cy*sx*sy+2*a*xx*yy*cx*cy*sx*sy+2*a*epn*xm*ym*cx*cy*sx*sy-2*a*epn*xx*ym*cx*cy*sx*sy-2*a*epn*xm*yy*cx*cy*sx*sy+2*a*epn*xx*yy*cx*cy*sx*sy))/(Mref*(cy*sx-10)*(xm^2-2*ym*yy-2*xm*xx+xx^2+ym^2+yy^2+1));
    end
end