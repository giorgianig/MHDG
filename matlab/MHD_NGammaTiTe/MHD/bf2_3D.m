% bf1_3D

function f = bf2_3D(X,t)
global testcase Mesh diff_n diff_u diff_ei diff_ee diff_pari diff_pare tie neq  epn pcourr
global Mref
D = diff_n;
mu = diff_u;
csii = diff_ei;
csie = diff_ee;
kpari = diff_pari;
kpare = diff_pare;
a = testcase.wavex;
a = 2*pi*a;

N2d = size(X,1);
N1d = size(t,1);

% allocation
f = zeros(N2d*N1d,neq);

% assign
x = X(:,1);
y = X(:,2);


xmax = Mesh.maxx;
xmin = Mesh.minx;
ymax = Mesh.maxy;
ymin = Mesh.miny;
xm = 0.5*(xmax+xmin);
ym = 0.5*(ymax+ymin);

for i=1:N2d
    for j=1:N1d
        xx = x(i);
        yy = y(i);
        ind = (j-1)*N2d+i;
        
        cx = cos(a*xx);
        cy = cos(a*yy);
        sx = sin(a*xx);
        sy = sin(a*yy);
        cx2 = cx^2;
        cy2 = cy^2;
        sx2 = sx^2;
        sy2 = sy^2;
        r = ((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2);
        r2 = ((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2);
        cc = cx*cy;
        ss = sx*sy;
        
        f(ind,1) = (2*a*xx^5*cx*sy*r2-6*D*a*xx^4*cx*sy-D*a*xm^4*cx*sy-2*xx*...
            ym^3*cc*r-2*xx^3*ym*cc*r+2*xx*yy^3*cc*r+2*xx^3*yy*cx*...
            cy*r+6*D*a^2*xx^5*ss-10*D*a^2*xm*xx^4*ss+D*a^2*xm^4*xx*...
            ss+D*a^2*xx*ym^4*ss+D*a^2*xx*yy^4*ss-a*xx^5*cx*cy2*sx*...
            r2+a*xx^5*cx*sx*sy2*r2+2*D*a^2*xx^2*ym^3*cc-2*D*a^2*xx^2*...
            yy^3*cc+9*D*a^2*xm^2*xx^3*ss-4*D*a^2*xm^3*xx^2*ss+5*...
            D*a^2*xx^3*ym^2*ss+5*D*a^2*xx^3*yy^2*ss+12*D*a*xm*xx^3*...
            cx*sy+5*D*a*xm^3*xx*cx*sy-D*a*xm*ym^3*cy*sx-D*a*xm^3*ym*cy*...
            sx+2*D*a*xx*ym^3*cy*sx+2*D*a*xx^3*ym*cy*sx+D*a*xm*yy^3*cy*sx+...
            D*a*xm^3*yy*cy*sx-2*D*a*xx*yy^3*cy*sx-2*D*a*xx^3*yy*cy*sx-2*a*...
            xm*xx^4*cx*sy*r2+2*a*xx^4*ym*cy*sx*r2-2*a*xx^4*yy*cy*sx*r2+4*...
            xm*xx^2*ym*cc*r-2*xm^2*xx*ym*cc*r-4*xm*xx^2*yy*cc*r+...
            2*xm^2*xx*yy*cc*r-6*xx*ym*yy^2*cc*r+6*xx*ym^2*yy*cc*...
            r+4*D*a^2*xx^4*ym*cc-4*D*a^2*xx^4*yy*cc-11*D*a*xm^2*xx^2*cx*sy-...
            D*a*xm^2*ym^2*cx*sy-5*D*a*xx^2*ym^2*cx*sy-D*a*xm^2*yy^2*cx*sy-...
            5*D*a*xx^2*yy^2*cx*sy+3*D*a*xm*xx*ym^2*cx*sy-4*D*a*xm*xx^2*ym*...
            cy*sx+4*D*a*xm^2*xx*ym*cy*sx+3*D*a*xm*xx*yy^2*cx*sy+4*D*a*...
            xm*xx^2*yy*cy*sx-4*D*a*xm^2*xx*yy*cy*sx-3*D*a*xm*ym*yy^2*cy*...
            sx+3*D*a*xm*ym^2*yy*cy*sx+2*D*a*xm^2*ym*yy*cx*sy+6*D*a*xx*ym*...
            yy^2*cy*sx-6*D*a*xx*ym^2*yy*cy*sx+10*D*a*xx^2*ym*yy*cx*sy-...
            2*D*a^2*xm*xx*ym^3*cc-8*D*a^2*xm*xx^3*ym*cc-2*D*a^2*xm^3*xx*ym*...
            cc+2*D*a^2*xm*xx*yy^3*cc+8*D*a^2*xm*xx^3*yy*cc+2*D*a^2*xm^3*xx*...
            yy*cx*cy-4*D*a^2*xx*ym*yy^3*ss-4*D*a^2*xx*ym^3*yy*ss-10*...
            D*a^2*xx^3*ym*yy*ss-xx*ym^3*cc*ss*r-xx^3*ym*cc*ss*r+xx*yy^3*...
            cc*ss*r+xx^3*yy*cc*ss*r+a*xm*xx^4*cx*cy2*sx*r2-a*xx^4*ym*cx2*...
            cy*sy*r2+a*xx^4*yy*cx2*cy*sy*r2-a*xm*xx^4*cx*sx*sy2*r2+a*xx^4*...
            ym*cy*sx2*sy*r2-a*xx^4*yy*cy*sx2*sy*r2+6*D*a^2*xm^2*xx^2*ym*cx*...
            cy-6*D*a^2*xm^2*xx^2*yy*cx*cy+6*D*a^2*xx^2*ym*yy^2*cx*cy-6*D*...
            a^2*xx^2*ym^2*yy*cx*cy-4*D*a^2*xm*xx^2*ym^2*ss+2*D*a^2*xm^2*xx*...
            ym^2*ss-4*D*a^2*xm*xx^2*yy^2*ss+2*D*a^2*xm^2*xx*yy^2*ss+6*D*...
            a^2*xx*ym^2*yy^2*ss+8*D*a^2*xm*xx^2*ym*yy*ss-4*D*a^2*xm^2*xx*...
            ym*yy*ss+2*xm*xx^2*ym*cc*ss*r-xm^2*xx*ym*cc*ss*r-2*xm*xx^2*yy*...
            cc*ss*r+xm^2*xx*yy*cc*ss*r-3*xx*ym*yy^2*cc*ss*r+3*xx*ym^2*yy*...
            cc*ss*r-6*D*a*xm*xx*ym*yy*cx*sy-6*D*a^2*xm*xx*ym*yy^2*cx*cy+6*...
            D*a^2*xm*xx*ym^2*yy*cc)/(xx*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+...
            yy^2)^2);
        f(ind,2) = Mref*(((xm-xx)*(((2*ss+4)*(a*cx*cy+a*cx2*cy*sy))/(3*Mref)+...
            (2*a*cy*sx*(cx*sy-(cx2*cy2)/2+20))/(3*Mref)-(2*a*cy*sx*...
            (cy*sx-10))/(3*Mref)+(a*ss*(2*ss+4))/(3*Mref)))/(xx*r)+((ym-yy)*...
            (((2*ss+4)*(a*ss-a*cx*cy2*sx))/(3*Mref)-(2*a*cx*sy*(cx*sy-...
            (cx2*cy2)/2+20))/(3*Mref)+(a*cc*(2*ss+4))/(3*Mref)+(2*a*cx*sy*...
            (cy*sx-10))/(3*Mref)))/(xx*r))-((a*cx^3*cy2*sy*(ym-yy))/r+...
            (cx2*cy2*(ss+2)*(ym-yy)*((2*xm-2*xx)/xx^2+(2*(xm-xx)^2)/xx^3+...
            (2*(ym-yy)^2)/xx^3))/(2*r2)-(2*a*cx*cy2*sx*(ss+2)*(ym-yy))/r)/xx+mu*...
            ((xx*(((ym-yy)*(((a*cx*cy2*sx-a*cx*sy*(ss+2))*(xm-xx))/(xx*r)-...
            ((a*cx2*cy*sy-a*cy*sx*(ss+2))*(ym-yy))/(xx*r)))/(xx^2*r)-((ym-yy)*...
            (((xm-xx)*(a^2*cx2*cy2-a^2*cx2*sy2-a^2*cy2*sx2+a^2*ss*(ss+2)))/(xx*r)-...
            (a*cx*cy2*sx-a*cx*sy*(ss+2))/(xx*r)+((a^2*cc*(ss+2)+3*a^2*cc*ss)*...
            (ym-yy))/(xx*r)-((a*cx*cy2*sx-a*cx*sy*(ss+2))*(xm-xx))/(xx^2*r)+...
            ((a*cx2*cy*sy-a*cy*sx*(ss+2))*(ym-yy))/(xx^2*r)+((a*cx*cy2*sx-a*cx*sy*...
            (ss+2))*(xm-xx)*((2*xm-2*xx)/xx^2+(2*(xm-xx)^2)/xx^3+(2*(ym-yy)^2)/...
            xx^3))/(2*xx*r2)-((a*cx2*cy*sy-a*cy*sx*(ss+2))*(ym-yy)*((2*xm-2*xx)/xx^2+...
            (2*(xm-xx)^2)/xx^3+(2*(ym-yy)^2)/xx^3))/(2*xx*r2)))/(xx*r)+a^2*cc*(ss+2)-...
            ((ym-yy)*(((a*cx*cy2*sx-a*cx*sy*(ss+2))*(xm-xx))/(xx*r)-((a*cx2*cy*sy-...
            a*cy*sx*(ss+2))*(ym-yy))/(xx*r))*((2*xm-2*xx)/xx^2+(2*(xm-xx)^2)/xx^3+(2*...
            (ym-yy)^2)/xx^3))/(2*xx*r2)+3*a^2*cc*ss)-a*cx2*cy*sy-((ym-yy)*(((a*cx*cy2*...
            sx-a*cx*sy*(ss+2))*(xm-xx))/(xx*r)-((a*cx2*cy*sy-a*cy*sx*(ss+2))*(ym-yy))/...
            (xx*r)))/(xx*r)+a*cy*sx*(ss+2))/xx+a^2*cc*(ss+2)-((xm-xx)*(((ym-yy)*...
            (a^2*cx2*cy2-a^2*cx2*sy2-a^2*cy2*sx2+a^2*ss*(ss+2)))/(xx*r)-(a*cx2*...
            cy*sy-a*cy*sx*(ss+2))/(xx*r)+((a^2*cc*(ss+2)+3*a^2*cc*ss)*(xm-xx))/...
            (xx*r)-((2*ym-2*yy)*(a*cx*cy2*sx-a*cx*sy*(ss+2))*(xm-xx))/(2*xx^3*r2)+...
            ((2*ym-2*yy)*(a*cx2*cy*sy-a*cy*sx*(ss+2))*(ym-yy))/(2*xx^3*r2)))/(xx*r)+...
            ((2*ym-2*yy)*(xm-xx)*(((a*cx*cy2*sx-a*cx*sy*(ss+2))*(xm-xx))/(xx*r)-...
            ((a*cx2*cy*sy-a*cy*sx*(ss+2))*(ym-yy))/(xx*r)))/(2*xx^3*r2)+3*a^2*cc*ss)+...
            (a*cx2*cy^3*sx*(xm-xx))/(xx*r)+(cx2*cy2*(2*ym-2*yy)*(ss+2)*(xm-xx))/...
            (2*xx^3*r2)-(2*a*cx2*cy*sy*(ss+2)*(xm-xx))/(xx*r);
        f(ind,3) = (a*csii*(11*xm^2*xx^2+xm^2*ym^2+5*xx^2*ym^2+xm^2*yy^2+5*...
            xx^2*yy^2-2*xm^4*cx2-12*xx^4*cx2-xm^4*cy2-6*xx^4*cy2-12*xm*xx^3-...
            5*xm^3*xx+xm^4+6*xx^4-22*xm^2*xx^2*cx2-2*xm^2*ym^2*cx2-10*xx^2*...
            ym^2*cx2-11*xm^2*xx^2*cy2-2*xm^2*yy^2*cx2-10*xx^2*yy^2*cx2-xm^2*...
            ym^2*cy2-5*xx^2*ym^2*cy2-xm^2*yy^2*cy2-5*xx^2*yy^2*cy2-3*xm*xx*...
            ym^2-3*xm*xx*yy^2-2*xm^2*ym*yy-10*xx^2*ym*yy+2*xm^4*cx2*cy2+12*...
            xx^4*cx2*cy2+10*a*xx^5*sin(2*a*xx)-20*xm^4*cx*sy-120*xx^4*cx*sy+...
            2*xm^4*ss+12*xx^4*ss+24*xm*xx^3*cx2+10*xm^3*xx*cx2+12*xm*xx^3*...
            cy2+5*xm^3*xx*cy2+22*xm^2*xx^2*cx2*cy2+2*xm^2*ym^2*cx2*cy2+10*...
            xx^2*ym^2*cx2*cy2+2*xm^2*yy^2*cx2*cy2+10*xx^2*yy^2*cx2*cy2-24*...
            xm*xx^3*ss-10*xm^3*xx*ss+17*a*xm^2*xx^3*sin(2*a*xx)-8*a*xm^3*...
            xx^2*sin(2*a*xx)+7*a*xx^3*ym^2*sin(2*a*xx)+7*a*xx^3*yy^2*...
            sin(2*a*xx)-2*a*xx^2*ym^3*sin(2*a*yy)+2*a*xx^2*yy^3*sin(2*a*yy)+...
            6*xm*xx*ym^2*cx2+6*xm*xx*yy^2*cx2+3*xm*xx*ym^2*cy2+4*xm^2*ym*...
            yy*cx2+20*xx^2*ym*yy*cx2+3*xm*xx*yy^2*cy2+2*xm^2*ym*yy*cy2+10*...
            xx^2*ym*yy*cy2+6*xm*xx*ym*yy-220*xm^2*xx^2*cx*sy-20*xm^2*ym^2*...
            cx*sy-100*xx^2*ym^2*cx*sy-20*xm^2*yy^2*cx*sy-100*xx^2*yy^2*cx*...
            sy+22*xm^2*xx^2*ss+2*xm^2*ym^2*ss+10*xx^2*ym^2*ss+...
            2*xm^2*yy^2*ss+10*xx^2*yy^2*ss-24*xm*xx^3*cx2*cy2-10*xm^3*xx*...
            cx2*cy2-18*a*xm*xx^4*sin(2*a*xx)+2*a*xm^4*xx*sin(2*a*xx)+a*xx*...
            ym^4*sin(2*a*xx)+a*xx*yy^4*sin(2*a*xx)-4*a*xx^4*ym*sin(2*a*yy)+...
            4*a*xx^4*yy*sin(2*a*yy)+12*a*xx^5*cx*sy-2*xm*ym^3*cx*cy-2*xm^3*...
            ym*cx*cy+4*xx*ym^3*cx*cy+4*xx^3*ym*cx*cy+2*xm*yy^3*cx*cy+2*xm^3*...
            yy*cx*cy-4*xx*yy^3*cx*cy-4*xx^3*yy*cx*cy+120*a*xx^5*ss+240*xm*...
            xx^3*cx*sy+100*xm^3*xx*cx*sy-20*xm*ym^3*cy*sx-20*xm^3*ym*cy*sx+...
            40*xx*ym^3*cy*sx+40*xx^3*ym*cy*sx+20*xm*yy^3*cy*sx+20*xm^3*yy*...
            cy*sx-40*xx*yy^3*cy*sx-40*xx^3*yy*cy*sx-6*xm*xx*ym^2*cx2*cy2-6*...
            xm*xx*yy^2*cx2*cy2-4*xm^2*ym*yy*cx2*cy2-20*xx^2*ym*yy*cx2*cy2+2*...
            a*xm*xx*ym^3*sin(2*a*yy)+8*a*xm*xx^3*ym*sin(2*a*yy)+2*a*xm^3*xx*...
            ym*sin(2*a*yy)-4*a*xx*ym*yy^3*sin(2*a*xx)-4*a*xx*ym^3*yy*sin(2*...
            a*xx)-14*a*xx^3*ym*yy*sin(2*a*xx)-2*a*xm*xx*yy^3*sin(2*a*yy)-8*...
            a*xm*xx^3*yy*sin(2*a*yy)-2*a*xm^3*xx*yy*sin(2*a*yy)-12*xm*xx*ym*...
            yy*cx2-6*xm*xx*ym*yy*cy2+80*a*xx^4*ym*cx*cy-80*a*xx^4*yy*cx*cy-...
            20*a*xm*xx^4*cx*sy+2*a*xm^4*xx*cx*sy+2*a*xx*ym^4*cx*sy-8*a*xx^4*...
            ym*cy*sx+2*a*xx*yy^4*cx*sy+8*a*xx^4*yy*cy*sx-8*xm*xx^2*ym*cx*cy+...
            8*xm^2*xx*ym*cx*cy+8*xm*xx^2*yy*cx*cy-8*xm^2*xx*yy*cx*cy-6*xm*ym*...
            yy^2*cx*cy+6*xm*ym^2*yy*cx*cy+12*xx*ym*yy^2*cx*cy-12*xx*ym^2*yy*...
            cx*cy-200*a*xm*xx^4*ss+20*a*xm^4*xx*ss+20*a*xx*ym^4*ss+20*a*xx*...
            yy^4*ss+60*xm*xx*ym^2*cx*sy-80*xm*xx^2*ym*cy*sx+80*xm^2*xx*ym*...
            cy*sx+60*xm*xx*yy^2*cx*sy+80*xm*xx^2*yy*cy*sx-80*xm^2*xx*yy*cy*...
            sx-60*xm*ym*yy^2*cy*sx+60*xm*ym^2*yy*cy*sx+40*xm^2*ym*yy*cx*sy+...
            120*xx*ym*yy^2*cy*sx-120*xx*ym^2*yy*cy*sx+200*xx^2*ym*yy*cx*sy-...
            6*xm*xx*ym^2*ss-6*xm*xx*yy^2*ss-4*xm^2*ym*yy*ss-20*xx^2*ym*yy*...
            ss-6*a*xm*xx^2*ym^2*sin(2*a*xx)+3*a*xm^2*xx*ym^2*sin(2*a*xx)-6*...
            a*xm*xx^2*yy^2*sin(2*a*xx)+3*a*xm^2*xx*yy^2*sin(2*a*xx)-6*a*xm^2*...
            xx^2*ym*sin(2*a*yy)+6*a*xx*ym^2*yy^2*sin(2*a*xx)+6*a*xm^2*xx^2*...
            yy*sin(2*a*yy)-6*a*xx^2*ym*yy^2*sin(2*a*yy)+6*a*xx^2*ym^2*yy*...
            sin(2*a*yy)+40*a*xx^2*ym^3*cx*cy-40*a*xx^2*yy^3*cx*cy+18*a*xm^2*...
            xx^3*cx*sy-8*a*xm^3*xx^2*cx*sy-4*a*xx^2*ym^3*cy*sx+10*a*xx^3*...
            ym^2*cx*sy+4*a*xx^2*yy^3*cy*sx+10*a*xx^3*yy^2*cx*sy+180*a*xm^2*...
            xx^3*ss-80*a*xm^3*xx^2*ss+100*a*xx^3*ym^2*ss+100*a*xx^3*yy^2*...
            ss-24*a*xx^5*cx*cy2*sx+120*a*xm^2*xx^2*ym*cx*cy-120*a*xm^2*xx^2*...
            yy*cx*cy+120*a*xx^2*ym*yy^2*cx*cy-120*a*xx^2*ym^2*yy*cx*cy-8*a*...
            xm*xx^2*ym^2*cx*sy+4*a*xm^2*xx*ym^2*cx*sy-12*a*xm^2*xx^2*ym*cy*...
            sx-8*a*xm*xx^2*yy^2*cx*sy+4*a*xm^2*xx*yy^2*cx*sy+12*a*xm^2*xx^2*...
            yy*cy*sx+12*a*xx*ym^2*yy^2*cx*sy-12*a*xx^2*ym*yy^2*cy*sx+12*a*...
            xx^2*ym^2*yy*cy*sx+12*xm*xx*ym*yy*cx2*cy2-80*a*xm*xx^2*ym^2*ss+...
            40*a*xm^2*xx*ym^2*ss-80*a*xm*xx^2*yy^2*ss+40*a*xm^2*xx*yy^2*ss-...
            2*xm*ym^3*cc*ss-2*xm^3*ym*cc*ss+4*xx*ym^3*cc*ss+4*xx^3*ym*cc*ss+...
            2*xm*yy^3*cc*ss+2*xm^3*yy*cc*ss-4*xx*yy^3*cc*ss-4*xx^3*yy*cc*ss+...
            120*a*xx*ym^2*yy^2*ss+40*a*xm*xx^4*cx*cy2*sx-4*a*xm^4*xx*cx*cy2*...
            sx-4*a*xx*ym^4*cx*cy2*sx-4*a*xx*yy^4*cx*cy2*sx+16*a*xx^4*ym*cx2*...
            cy*sy-16*a*xx^4*yy*cx2*cy*sy-120*xm*xx*ym*yy*cx*sy+12*xm*xx*ym*...
            yy*ss+12*a*xm*xx^2*ym*yy*sin(2*a*xx)-6*a*xm^2*xx*ym*yy*sin(2*a*...
            xx)+6*a*xm*xx*ym*yy^2*sin(2*a*yy)-6*a*xm*xx*ym^2*yy*sin(2*a*yy)-...
            36*a*xm^2*xx^3*cx*cy2*sx+16*a*xm^3*xx^2*cx*cy2*sx-20*a*xx^3*ym^2*...
            cx*cy2*sx-20*a*xx^3*yy^2*cx*cy2*sx+8*a*xx^2*ym^3*cx2*cy*sy-8*a*...
            xx^2*yy^3*cx2*cy*sy-40*a*xm*xx*ym^3*cx*cy-160*a*xm*xx^3*ym*cx*...
            cy-40*a*xm^3*xx*ym*cx*cy+40*a*xm*xx*yy^3*cx*cy+160*a*xm*xx^3*yy*...
            cx*cy+40*a*xm^3*xx*yy*cx*cy+4*a*xm*xx*ym^3*cy*sx+16*a*xm*xx^3*...
            ym*cy*sx+4*a*xm^3*xx*ym*cy*sx-4*a*xm*xx*yy^3*cy*sx-16*a*xm*xx^3*...
            yy*cy*sx-4*a*xm^3*xx*yy*cy*sx-8*a*xx*ym*yy^3*cx*sy-8*a*xx*ym^3*...
            yy*cx*sy-20*a*xx^3*ym*yy*cx*sy-80*a*xx*ym*yy^3*ss-80*a*xx*ym^3*...
            yy*ss-200*a*xx^3*ym*yy*ss+16*a*xm*xx^2*ym^2*cx*cy2*sx-8*a*xm^2*...
            xx*ym^2*cx*cy2*sx+16*a*xm*xx^2*yy^2*cx*cy2*sx-8*a*xm^2*xx*yy^2*...
            cx*cy2*sx+24*a*xm^2*xx^2*ym*cx2*cy*sy-24*a*xx*ym^2*yy^2*cx*cy2*...
            sx-24*a*xm^2*xx^2*yy*cx2*cy*sy+24*a*xx^2*ym*yy^2*cx2*cy*sy-24*a*...
            xx^2*ym^2*yy*cx2*cy*sy-120*a*xm*xx*ym*yy^2*cx*cy+120*a*xm*xx*...
            ym^2*yy*cx*cy+12*a*xm*xx*ym*yy^2*cy*sx-12*a*xm*xx*ym^2*yy*cy*sx+...
            16*a*xm*xx^2*ym*yy*cx*sy-8*a*xm^2*xx*ym*yy*cx*sy+160*a*xm*xx^2*...
            ym*yy*ss-80*a*xm^2*xx*ym*yy*ss-8*xm*xx^2*ym*cc*ss+8*xm^2*xx*ym*...
            cc*ss+8*xm*xx^2*yy*cc*ss-8*xm^2*xx*yy*cc*ss-6*xm*ym*yy^2*cc*ss+...
            6*xm*ym^2*yy*cc*ss+12*xx*ym*yy^2*cc*ss-12*xx*ym^2*yy*cc*ss-8*a*...
            xm*xx*ym^3*cx2*cy*sy-32*a*xm*xx^3*ym*cx2*cy*sy-8*a*xm^3*xx*ym*...
            cx2*cy*sy+16*a*xx*ym*yy^3*cx*cy2*sx+16*a*xx*ym^3*yy*cx*cy2*sx+...
            40*a*xx^3*ym*yy*cx*cy2*sx+8*a*xm*xx*yy^3*cx2*cy*sy+32*a*xm*xx^3*...
            yy*cx2*cy*sy+8*a*xm^3*xx*yy*cx2*cy*sy-32*a*xm*xx^2*ym*yy*cx*cy2*...
            sx+16*a*xm^2*xx*ym*yy*cx*cy2*sx-24*a*xm*xx*ym*yy^2*cx2*cy*sy+24*...
            a*xm*xx*ym^2*yy*cx2*cy*sy))/(xx*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+...
            ym^2+yy^2)^2)-((a*cc*(ym-yy)*(5*cx2*sy2-5*sx2*sy2+100*cx*sy-10*...
            ss-cx^3*cy2*sy+4*cx*cy2*sx+2*cx*cy2*sx2*sy))/(3*((xm^2-2*ym*yy-2*...
            xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2))-(a*cy*sx*(ss+2)*(ym-yy)*...
            (5*cx*sy-cx2*cy2+100))/(3*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+...
            yy^2)/xx^2)^(1/2))+(cc*(ss+2)*(ym-yy)*(5*cx*sy-cx2*cy2+100)*...
            (xm^2-2*ym*yy-xm*xx+ym^2+yy^2))/(3*xx^3*((xm^2-2*ym*yy-2*xm*xx+...
            2*xx^2+ym^2+yy^2)/xx^2)^(3/2)))/xx-kpari*(((1/3^(epn+1)*xx*((2*...
            cx*sy-cx2*cy2+40)/Mref)^epn*(ym-yy)*(2*a^2*yy^3*cy2-2*a^2*ym^3*...
            cy2+2*a^2*xm^3*cy*sx-4*a^2*xx^3*cy*sx-2*a^2*ym^3*cx*sy+2*a^2*...
            yy^3*cx*sy-2*a^2*xm^2*ym*cy2-4*a^2*xx^2*ym*cy2+2*a^2*xm^2*yy*...
            cy2+4*a^2*xx^2*yy*cy2-6*a^2*ym*yy^2*cy2+6*a^2*ym^2*yy*cy2+2*a*...
            ym^2*cx*cy+2*a*yy^2*cx*cy+4*a^2*ym^3*cx2*cy2-4*a^2*yy^3*cx2*cy2-...
            2*a*xm*ym*ss+4*a*xx*ym*ss+2*a*xm*yy*ss-4*a*xx*yy*ss+4*a^2*xm^2*...
            ym*cx2*cy2+8*a^2*xx^2*ym*cx2*cy2-4*a^2*xm^2*yy*cx2*cy2-8*a^2*...
            xx^2*yy*cx2*cy2+12*a^2*ym*yy^2*cx2*cy2-12*a^2*ym^2*yy*cx2*cy2+...
            4*a^2*xm*xx*ym*cy2-4*a^2*xm*xx*yy*cy2+8*a^2*xm*xx^2*cy*sx-6*a^2*...
            xm^2*xx*cy*sx+2*a^2*xm*ym^2*cy*sx-2*a^2*xm^2*ym*cx*sy-2*a^2*xx*...
            ym^2*cy*sx-4*a^2*xx^2*ym*cx*sy+2*a^2*xm*yy^2*cy*sx+2*a^2*xm^2*...
            yy*cx*sy-2*a^2*xx*yy^2*cy*sx+4*a^2*xx^2*yy*cx*sy-6*a^2*ym*yy^2*...
            cx*sy+6*a^2*ym^2*yy*cx*sy+2*a*ym^2*cx2*cy*sy+2*a*yy^2*cx2*cy*sy+...
            2*a*xm*xx*cx*cy-4*a*ym*yy*cx*cy-8*a^2*xm*xx*ym*cx2*cy2+8*a^2*xm*...
            xx*yy*cx2*cy2+4*a^2*xm^3*cc*ss-8*a^2*xx^3*cc*ss+4*a^2*xm*xx*ym*...
            cx*sy-4*a^2*xm*xx*yy*cx*sy-4*a^2*xm*ym*yy*cy*sx+4*a^2*xx*ym*yy*...
            cy*sx+2*a*xm*ym*cx*cy2*sx-4*a*xx*ym*cx*cy2*sx+2*a*xm*xx*cx2*cy*...
            sy-2*a*xm*yy*cx*cy2*sx+4*a*xx*yy*cx*cy2*sx-4*a*ym*yy*cx2*cy*sy+...
            16*a^2*xm*xx^2*cc*ss-12*a^2*xm^2*xx*cc*ss+4*a^2*xm*ym^2*cc*ss-4*...
            a^2*xx*ym^2*cc*ss+4*a^2*xm*yy^2*cc*ss-4*a^2*xx*yy^2*cc*ss-8*a^2*...
            xm*ym*yy*cc*ss+8*a^2*xx*ym*yy*cc*ss))/(Mref*(xm^2-2*ym*yy-2*xm*...
            xx+2*xx^2+ym^2+yy^2)^2)-(2/3^(epn+1)*a*((2*cx*sy-cx2*cy2+40)/...
            Mref)^epn*(ym-yy)*(xm^2-2*ym*yy-xm*xx+ym^2+yy^2)*(xm*cx*cy-xx*...
            cx*cy+ym*ss-yy*ss-ym*cx*cy2*sx+xm*cx2*cy*sy-xx*cx2*cy*sy+yy*cx*...
            cy2*sx))/(Mref*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)^2)+...
            (4/3^(epn+1)*a^2*epn*xx*sx*(sy-cx*cy2)*((2*cx*sy-cx2*cy2+...
            40)/Mref)^(epn-1)*(ym-yy)*(xm*cx*cy-xx*cx*cy+ym*ss-yy*ss-ym*...
            cx*cy2*sx+xm*cx2*cy*sy-xx*cx2*cy*sy+yy*cx*cy2*sx))/(Mref^2*...
            (xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)))/xx-(1/3^(epn+1)*...
            ((2*cx*sy-cx2*cy2+40)/Mref)^epn*(xm-xx)*(2*a^2*xm^3*cx2-4*a^2*...
            xx^3*cx2+2*a^2*xm^3*cx*sy-4*a^2*xx^3*cx*sy-2*a^2*ym^3*cy*sx+2*...
            a^2*yy^3*cy*sx+8*a^2*xm*xx^2*cx2-6*a^2*xm^2*xx*cx2+2*a^2*xm*...
            ym^2*cx2-2*a^2*xx*ym^2*cx2+2*a^2*xm*yy^2*cx2-2*a^2*xx*yy^2*cx2-...
            4*a^2*xm^3*cx2*cy2+8*a^2*xx^3*cx2*cy2+2*a*xm^2*ss+4*a*xx^2*ss-...
            4*a*xm*xx*ss-16*a^2*xm*xx^2*cx2*cy2+12*a^2*xm^2*xx*cx2*cy2-4*...
            a^2*xm*ym^2*cx2*cy2+4*a^2*xx*ym^2*cx2*cy2-4*a^2*xm*yy^2*cx2*cy2+...
            4*a^2*xx*yy^2*cx2*cy2-4*a^2*xm*ym*yy*cx2+4*a^2*xx*ym*yy*cx2+8*...
            a^2*xm*xx^2*cx*sy-6*a^2*xm^2*xx*cx*sy+2*a^2*xm*ym^2*cx*sy-2*a^2*...
            xm^2*ym*cy*sx-2*a^2*xx*ym^2*cx*sy-4*a^2*xx^2*ym*cy*sx+2*a^2*xm*...
            yy^2*cx*sy+2*a^2*xm^2*yy*cy*sx-2*a^2*xx*yy^2*cx*sy+4*a^2*xx^2*...
            yy*cy*sx-6*a^2*ym*yy^2*cy*sx+6*a^2*ym^2*yy*cy*sx-2*a*xm^2*cx*cy2*...
            sx-4*a*xx^2*cx*cy2*sx-2*a*xm*ym*cx*cy+2*a*xx*ym*cx*cy+2*a*xm*yy*...
            cx*cy-2*a*xx*yy*cx*cy+8*a^2*xm*ym*yy*cx2*cy2-8*a^2*xx*ym*yy*cx2*...
            cy2-4*a^2*ym^3*cc*ss+4*a^2*yy^3*cc*ss+4*a^2*xm*xx*ym*cy*sx-4*a^2*...
            xm*xx*yy*cy*sx-4*a^2*xm*ym*yy*cx*sy+4*a^2*xx*ym*yy*cx*sy+4*a*xm*...
            xx*cx*cy2*sx-2*a*xm*ym*cx2*cy*sy+2*a*xx*ym*cx2*cy*sy+2*a*xm*yy*...
            cx2*cy*sy-2*a*xx*yy*cx2*cy*sy-4*a^2*xm^2*ym*cc*ss-8*a^2*xx^2*ym*...
            cc*ss+4*a^2*xm^2*yy*cc*ss+8*a^2*xx^2*yy*cc*ss-12*a^2*ym*yy^2*cc*...
            ss+12*a^2*ym^2*yy*cc*ss+8*a^2*xm*xx*ym*cc*ss-8*a^2*xm*xx*yy*cc*...
            ss))/(Mref*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)^2)+(1/3^(epn+1)*...
            a*(2*ym-2*yy)*((2*cx*sy-cx2*cy2+40)/Mref)^epn*(xm-xx)*(xm*cx*cy-...
            xx*cx*cy+ym*ss-yy*ss-ym*cx*cy2*sx+xm*cx2*cy*sy-xx*cx2*cy*sy+yy*...
            cx*cy2*sx))/(Mref*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)^2)+...
            (4/3^(epn+1)*a^2*epn*cc*(cx*sy+1)*((2*cx*sy-cx2*cy2+40)/Mref)^(epn-1)*...
            (xm-xx)*(xm*cx*cy-xx*cx*cy+ym*ss-yy*ss-ym*cx*cy2*sx+xm*cx2*cy*sy-...
            xx*cx2*cy*sy+yy*cx*cy2*sx))/(Mref^2*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+...
            ym^2+yy^2)))+Mref*pcourr*cc*((2*a*sx*(xm-xx)*(10*cy+sx+2*sy-2*...
            cy2*sx))/(3*Mref*xx*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/...
            xx^2)^(1/2))+(4*a*cx*(ym-yy)*(cy-5*sy+cy*ss))/(3*Mref*xx*((xm^2-...
            2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2)))+(3^(1/2)*(ss+2)^2*...
            (2*cx*sy-cx2*cy2+2*cy*sx+20))/(2*tie*(cy*sx-10)*(-(2*cy*sx-20)/Mref)^(1/2))+...
            (a*cx*cy2*(xm-xx)*(10*cx+100*sx+2*cx2*sx+4*cx2*sy-3*cx2*cy2*sx+...
            10*cx*ss))/(3*xx*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2))+...
            (cc*(2*ym-2*yy)*(ss+2)*(xm-xx)*(5*cx*sy-cx2*cy2+100))/(6*xx^3*((xm^2-...
            2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(3/2))-(a*cx*sy*(ss+2)*(xm-xx)*...
            (5*cx*sy-cx2*cy2+100))/(3*xx*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/...
            xx^2)^(1/2));
        f(ind,4) =  ((10*a*cx2*cy*(ym-yy)*(cy-5*sy+cy*ss))/(3*((xm^2-2*ym*yy-...
            2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2))-(5*a*cy*sx*(cy*sx-10)*(ss+2)*...
            (ym-yy))/(3*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2))+...
            (5*cc*(cy*sx-10)*(ss+2)*(ym-yy)*(xm^2-2*ym*yy-xm*xx+ym^2+yy^2))/...
            (3*xx^3*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(3/2)))/xx+...
            (4*3^(1-epn)*Mref*a*kpare*ym^4*cc*(-(2*cy*sx-20)/Mref)^epn+4*3^(1-epn)*...
            Mref*a*kpare*yy^4*cc*(-(2*cy*sx-20)/Mref)^epn-2*3^(1-epn)*Mref*...
            a^2*kpare*xx^3*cy*sx*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*...
            xx+2*xx^2+ym^2+yy^2)-16*3^(1-epn)*Mref*a*kpare*ym*yy^3*cc*(-(2*cy*sx-20)/...
            Mref)^epn-16*3^(1-epn)*Mref*a*kpare*ym^3*yy*cc*(-(2*cy*sx-20)/...
            Mref)^epn+4*3^(1-epn)*Mref*a*kpare*xm*ym^3*ss*(-(2*cy*sx-20)/Mref)^epn+...
            4*3^(1-epn)*Mref*a*kpare*xm^3*ym*ss*(-(2*cy*sx-20)/Mref)^epn-4*...
            3^(1-epn)*Mref*a*kpare*xx*ym^3*ss*(-(2*cy*sx-20)/Mref)^epn-4*3^...
            (1-epn)*Mref*a*kpare*xx^3*ym*ss*(-(2*cy*sx-20)/Mref)^epn-4*3^...
            (1-epn)*Mref*a*kpare*xm*yy^3*ss*(-(2*cy*sx-20)/Mref)^epn-4*3^...
            (1-epn)*Mref*a*kpare*xm^3*yy*ss*(-(2*cy*sx-20)/Mref)^epn+4*3^...
            (1-epn)*Mref*a*kpare*xx*yy^3*ss*(-(2*cy*sx-20)/Mref)^epn+4*3^...
            (1-epn)*Mref*a*kpare*xx^3*yy*ss*(-(2*cy*sx-20)/Mref)^epn-2*3^...
            (1-epn)*Mref*a*kpare*xx^2*cc*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*...
            ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)-2*3^(1-epn)*Mref*a*kpare*ym^2*...
            cc*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+...
            yy^2)-2*3^(1-epn)*Mref*a*kpare*yy^2*cc*(-(2*cy*sx-20)/Mref)^epn*...
            (xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)+4*3^(1-epn)*Mref*a*kpare*...
            xm^2*ym^2*cc*(-(2*cy*sx-20)/Mref)^epn+4*3^(1-epn)*Mref*a*kpare*...
            xx^2*ym^2*cc*(-(2*cy*sx-20)/Mref)^epn+4*3^(1-epn)*Mref*a*kpare*...
            xm^2*yy^2*cc*(-(2*cy*sx-20)/Mref)^epn+4*3^(1-epn)*Mref*a*kpare*...
            xx^2*yy^2*cc*(-(2*cy*sx-20)/Mref)^epn+8*3^(2-epn)*Mref*a*kpare*...
            ym^2*yy^2*cc*(-(2*cy*sx-20)/Mref)^epn+4*3^(1-epn)*Mref*a^2*kpare*...
            xm*xx^2*cy*sx*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*...
            xx^2+ym^2+yy^2)-2*3^(1-epn)*Mref*a^2*kpare*xm^2*xx*cy*sx*(-(2*cy*...
            sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)-2*3^...
            (1-epn)*Mref*a^2*kpare*xx*ym^2*cy*sx*(-(2*cy*sx-20)/Mref)^epn*...
            (xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)-4*3^(1-epn)*Mref*a^2*...
            kpare*xx^2*ym*cx*sy*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*...
            xx+2*xx^2+ym^2+yy^2)-2*3^(1-epn)*Mref*a^2*kpare*xx*yy^2*cy*sx*...
            (-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)+...
            4*3^(1-epn)*Mref*a^2*kpare*xx^2*yy*cx*sy*(-(2*cy*sx-20)/Mref)^...
            epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)+2*3^(1-epn)*Mref*a*...
            kpare*xm*xx*cc*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*...
            xx^2+ym^2+yy^2)+4*3^(1-epn)*Mref*a*kpare*ym*yy*cc*(-(2*cy*sx-20)/...
            Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)-8*3^(1-epn)*...
            Mref*a*kpare*xm*xx*ym^2*cc*(-(2*cy*sx-20)/Mref)^epn-8*3^(1-epn)*...
            Mref*a*kpare*xm*xx*yy^2*cc*(-(2*cy*sx-20)/Mref)^epn-8*3^(1-epn)*...
            Mref*a*kpare*xm^2*ym*yy*cc*(-(2*cy*sx-20)/Mref)^epn-8*3^(1-epn)*...
            Mref*a*kpare*xx^2*ym*yy*cc*(-(2*cy*sx-20)/Mref)^epn-2*3^(1-epn)*...
            Mref*a*kpare*xm*ym*ss*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*...
            xm*xx+2*xx^2+ym^2+yy^2)+2*3^(1-epn)*Mref*a*kpare*xm*yy*ss*(-(2*...
            cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)+4*...
            3^(2-epn)*Mref*a*kpare*xm*xx^2*ym*ss*(-(2*cy*sx-20)/Mref)^epn-4*...
            3^(2-epn)*Mref*a*kpare*xm^2*xx*ym*ss*(-(2*cy*sx-20)/Mref)^epn-4*...
            3^(2-epn)*Mref*a*kpare*xm*xx^2*yy*ss*(-(2*cy*sx-20)/Mref)^epn+4*...
            3^(2-epn)*Mref*a*kpare*xm^2*xx*yy*ss*(-(2*cy*sx-20)/Mref)^epn+4*...
            3^(2-epn)*Mref*a*kpare*xm*ym*yy^2*ss*(-(2*cy*sx-20)/Mref)^epn-4*...
            3^(2-epn)*Mref*a*kpare*xm*ym^2*yy*ss*(-(2*cy*sx-20)/Mref)^epn-4*...
            3^(2-epn)*Mref*a*kpare*xx*ym*yy^2*ss*(-(2*cy*sx-20)/Mref)^epn+4*...
            3^(2-epn)*Mref*a*kpare*xx*ym^2*yy*ss*(-(2*cy*sx-20)/Mref)^epn+4*...
            3^(1-epn)*Mref*a^2*kpare*xm*xx*ym*cx*sy*(-(2*cy*sx-20)/Mref)^epn*...
            (xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)-4*3^(1-epn)*Mref*a^2*kpare*...
            xm*xx*yy*cx*sy*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*...
            xx^2+ym^2+yy^2)+4*3^(1-epn)*Mref*a^2*kpare*xx*ym*yy*cy*sx*(-(2*cy*...
            sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)+(4*3^(1-epn)*...
            Mref*a^2*epn*kpare*xx^3*sx2*sy2*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*...
            ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)+16*3^(1-epn)*Mref*a*...
            kpare*xm*xx*ym*yy*cc*(-(2*cy*sx-20)/Mref)^epn+(4*3^(1-epn)*Mref*a^2*...
            epn*kpare*xx*ym^2*cx2*cy2*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*...
            xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)+(4*3^(1-epn)*Mref*a^2*epn*kpare*xx*...
            yy^2*cx2*cy2*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+...
            ym^2+yy^2))/(2*cy*sx-20)-(8*3^(1-epn)*Mref*a^2*epn*kpare*xm*xx^2*sx2*...
            sy2*(-(2*cy*sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/...
            (2*cy*sx-20)+(4*3^(1-epn)*Mref*a^2*epn*kpare*xm^2*xx*sx2*sy2*(-(2*cy*...
            sx-20)/Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)-...
            (8*3^(1-epn)*Mref*a^2*epn*kpare*xx*ym*yy*cx2*cy2*(-(2*cy*sx-20)/...
            Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)-...
            (8*3^(1-epn)*Mref*a^2*epn*kpare*xx^2*ym*cc*ss*(-(2*cy*sx-20)/...
            Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)+...
            (8*3^(1-epn)*Mref*a^2*epn*kpare*xx^2*yy*cc*ss*(-(2*cy*sx-20)/...
            Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)+...
            (8*3^(1-epn)*Mref*a^2*epn*kpare*xm*xx*ym*cc*ss*(-(2*cy*sx-20)/...
            Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20)-...
            (8*3^(1-epn)*Mref*a^2*epn*kpare*xm*xx*yy*cc*ss*(-(2*cy*sx-20)/...
            Mref)^epn*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2))/(2*cy*sx-20))/...
            (9*Mref^2*xx*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)^2)-...
             Mref*pcourr*cc*((2*a*sx*(xm-xx)*(10*cy+sx+2*sy-2*cy2*sx))/...
             (3*Mref*xx*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^...
             (1/2))+(4*a*cx*(ym-yy)*(cy-5*sy+cy*ss))/(3*Mref*xx*((xm^2-2*...
             ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2)))+(a*csie*(2*xm^4*...
             cx*cy+12*xx^4*cx*cy-10*xm^4*cx*sy-60*xx^4*cx*sy-2*xm*ym^3*ss-...
             2*xm^3*ym*ss+4*xx*ym^3*ss+4*xx^3*ym*ss+2*xm*yy^3*ss+...
             2*xm^3*yy*ss-4*xx*yy^3*ss-4*xx^3*yy*ss+22*xm^2*xx^2*cx*cy+2*...
             xm^2*ym^2*cx*cy+10*xx^2*ym^2*cx*cy+2*xm^2*yy^2*cx*cy+...
             10*xx^2*yy^2*cx*cy-110*xm^2*xx^2*cx*sy-10*xm^2*ym^2*cx*sy-50*...
             xx^2*ym^2*cx*sy-10*xm^2*yy^2*cx*sy-50*xx^2*yy^2*cx*sy+...
             xm*ym^3*cy2*sx2+xm^3*ym*cy2*sx2-2*xx*ym^3*cy2*sx2-2*xx^3*ym*...
             cy2*sx2-xm*yy^3*cy2*sx2-xm^3*yy*cy2*sx2+2*xx*yy^3*cy2*sx2+2*...
             xx^3*yy*cy2*sx2-xm*ym^3*sx2*sy2-xm^3*ym*sx2*sy2+2*xx*ym^3*sx2*...
             sy2+2*xx^3*ym*sx2*sy2+xm*yy^3*sx2*sy2+xm^3*yy*sx2*sy2-2*xx*...
             yy^3*sx2*sy2-2*xx^3*yy*sx2*sy2-12*a*xx^5*cy*sx-24*xm*xx^3*cx*...
             cy-10*xm^3*xx*cx*cy+60*a*xx^5*ss+120*xm*xx^3*cx*sy+50*xm^3*xx*...
             cx*sy-10*xm*ym^3*cy*sx-10*xm^3*ym*cy*sx+20*xx*ym^3*cy*sx+20*...
             xx^3*ym*cy*sx+10*xm*yy^3*cy*sx+10*xm^3*yy*cy*sx-20*xx*yy^3*...
             cy*sx-20*xx^3*yy*cy*sx+4*xm*xx^2*ym*cy2*sx2-4*xm^2*xx*ym*cy2*...
             sx2-4*xm*xx^2*yy*cy2*sx2+4*xm^2*xx*yy*cy2*sx2+3*xm*ym*yy^2*...
             cy2*sx2-3*xm*ym^2*yy*cy2*sx2-6*xx*ym*yy^2*cy2*sx2+6*xx*ym^2*...
             yy*cy2*sx2-4*xm*xx^2*ym*sx2*sy2+4*xm^2*xx*ym*sx2*sy2+4*xm*...
             xx^2*yy*sx2*sy2-4*xm^2*xx*yy*sx2*sy2-3*xm*ym*yy^2*sx2*sy2+3*...
             xm*ym^2*yy*sx2*sy2+6*xx*ym*yy^2*sx2*sy2-6*xx*ym^2*yy*sx2*sy2+...
             40*a*xx^4*ym*cx*cy-40*a*xx^4*yy*cx*cy+20*a*xm*xx^4*cy*sx-2*a*...
             xm^4*xx*cy*sx-2*a*xx*ym^4*cy*sx+8*a*xx^4*ym*cx*sy-2*a*xx*yy^4*...
             cy*sx-8*a*xx^4*yy*cx*sy-6*xm*xx*ym^2*cx*cy-6*xm*xx*yy^2*cx*cy-...
             4*xm^2*ym*yy*cx*cy-20*xx^2*ym*yy*cx*cy-100*a*xm*xx^4*ss+10*a*...
             xm^4*xx*ss+10*a*xx*ym^4*ss+10*a*xx*yy^4*ss+30*xm*xx*ym^2*cx*sy-...
             40*xm*xx^2*ym*cy*sx+40*xm^2*xx*ym*cy*sx+30*xm*xx*yy^2*cx*sy+40*...
             xm*xx^2*yy*cy*sx-40*xm^2*xx*yy*cy*sx-30*xm*ym*yy^2*cy*sx+30*xm*...
             ym^2*yy*cy*sx+20*xm^2*ym*yy*cx*sy+60*xx*ym*yy^2*cy*sx-60*xx*...
             ym^2*yy*cy*sx+100*xx^2*ym*yy*cx*sy-8*xm*xx^2*ym*ss+8*xm^2*xx*...
             ym*ss+8*xm*xx^2*yy*ss-8*xm^2*xx*yy*ss-6*xm*ym*yy^2*ss+6*xm*...
             ym^2*yy*ss+12*xx*ym*yy^2*ss-12*xx*ym^2*yy*ss+20*a*xx^2*ym^3*...
             cx*cy-20*a*xx^2*yy^3*cx*cy-18*a*xm^2*xx^3*cy*sx+8*a*xm^3*xx^2*...
             cy*sx+4*a*xx^2*ym^3*cx*sy-10*a*xx^3*ym^2*cy*sx-4*a*xx^2*yy^3*...
             cx*sy-10*a*xx^3*yy^2*cy*sx+90*a*xm^2*xx^3*ss-40*a*xm^3*xx^2*...
             ss+2*xm^4*cc*ss+12*xx^4*cc*ss+50*a*xx^3*ym^2*ss+50*a*xx^3*yy^2*...
             ss+8*a*xx^5*cx2*cy*sy-16*a*xx^5*cy*sx2*sy+60*a*xm^2*xx^2*ym*...
             cx*cy-60*a*xm^2*xx^2*yy*cx*cy+60*a*xx^2*ym*yy^2*cx*cy-60*a*...
             xx^2*ym^2*yy*cx*cy+8*a*xm*xx^2*ym^2*cy*sx-4*a*xm^2*xx*ym^2*...
             cy*sx+12*a*xm^2*xx^2*ym*cx*sy+8*a*xm*xx^2*yy^2*cy*sx-4*a*xm^2*...
             xx*yy^2*cy*sx-12*a*xm^2*xx^2*yy*cx*sy-12*a*xx*ym^2*yy^2*cy*...
             sx+12*a*xx^2*ym*yy^2*cx*sy-12*a*xx^2*ym^2*yy*cx*sy-24*xm*xx^3*...
             cc*ss-10*xm^3*xx*cc*ss-40*a*xm*xx^2*ym^2*ss+20*a*xm^2*xx*ym^2*...
             ss-40*a*xm*xx^2*yy^2*ss+20*a*xm^2*xx*yy^2*ss+60*a*xx*ym^2*yy^2*...
             ss-8*a*xx^4*ym*cx*cy2*sx-16*a*xm*xx^4*cx2*cy*sy+2*a*xm^4*xx*cx2*...
             cy*sy+8*a*xx^4*yy*cx*cy2*sx+8*a*xx^4*ym*cx*sx*sy2+24*a*xm*xx^4*...
             cy*sx2*sy-2*a*xm^4*xx*cy*sx2*sy-8*a*xx^4*yy*cx*sx*sy2-4*a*xx*...
             ym^4*cy*sx2*sy-4*a*xx*yy^4*cy*sx2*sy+12*xm*xx*ym*yy*cx*cy-60*...
             xm*xx*ym*yy*cx*sy+22*xm^2*xx^2*cc*ss+2*xm^2*ym^2*cc*ss+10*xx^2*...
             ym^2*cc*ss+2*xm^2*yy^2*cc*ss+10*xx^2*yy^2*cc*ss-4*a*xx^2*ym^3*...
             cx*cy2*sx+16*a*xm^2*xx^3*cx2*cy*sy-8*a*xm^3*xx^2*cx2*cy*sy+4*...
             a*xx^2*yy^3*cx*cy2*sx+4*a*xx^3*ym^2*cx2*cy*sy+4*a*xx^3*yy^2*cx2*...
             cy*sy-20*a*xm*xx*ym^3*cx*cy-80*a*xm*xx^3*ym*cx*cy-20*a*xm^3*xx*...
             ym*cx*cy+20*a*xm*xx*yy^3*cx*cy+80*a*xm*xx^3*yy*cx*cy+20*a*xm^3*...
             xx*yy*cx*cy+4*a*xx^2*ym^3*cx*sx*sy2-20*a*xm^2*xx^3*cy*sx2*sy+8*...
             a*xm^3*xx^2*cy*sx2*sy-4*a*xx^2*yy^3*cx*sx*sy2-16*a*xx^3*ym^2*cy*...
             sx2*sy-16*a*xx^3*yy^2*cy*sx2*sy-4*a*xm*xx*ym^3*cx*sy-16*a*xm*...
             xx^3*ym*cx*sy-4*a*xm^3*xx*ym*cx*sy+4*a*xm*xx*yy^3*cx*sy+16*a*...
             xm*xx^3*yy*cx*sy+4*a*xm^3*xx*yy*cx*sy+8*a*xx*ym*yy^3*cy*sx+8*...
             a*xx*ym^3*yy*cy*sx+20*a*xx^3*ym*yy*cy*sx-40*a*xx*ym*yy^3*ss-40*...
             a*xx*ym^3*yy*ss-100*a*xx^3*ym*yy*ss-12*a*xm^2*xx^2*ym*cx*cy2*...
             sx+12*a*xm^2*xx^2*yy*cx*cy2*sx-4*a*xm*xx^2*ym^2*cx2*cy*sy+2*...
             a*xm^2*xx*ym^2*cx2*cy*sy-12*a*xx^2*ym*yy^2*cx*cy2*sx+12*a*xx^2*...
             ym^2*yy*cx*cy2*sx-4*a*xm*xx^2*yy^2*cx2*cy*sy+2*a*xm^2*xx*yy^2*...
             cx2*cy*sy-60*a*xm*xx*ym*yy^2*cx*cy+60*a*xm*xx*ym^2*yy*cx*cy+...
             12*a*xm^2*xx^2*ym*cx*sx*sy2-12*a*xm^2*xx^2*yy*cx*sx*sy2+12*a*...
             xm*xx^2*ym^2*cy*sx2*sy-6*a*xm^2*xx*ym^2*cy*sx2*sy+12*a*xx^2*...
             ym*yy^2*cx*sx*sy2-12*a*xx^2*ym^2*yy*cx*sx*sy2+12*a*xm*xx^2*...
             yy^2*cy*sx2*sy-6*a*xm^2*xx*yy^2*cy*sx2*sy-24*a*xx*ym^2*yy^2*...
             cy*sx2*sy-12*a*xm*xx*ym*yy^2*cx*sy+12*a*xm*xx*ym^2*yy*cx*sy-...
             16*a*xm*xx^2*ym*yy*cy*sx+8*a*xm^2*xx*ym*yy*cy*sx+80*a*xm*xx^2*...
             ym*yy*ss-40*a*xm^2*xx*ym*yy*ss-6*xm*xx*ym^2*cc*ss-6*xm*xx*yy^2*...
             cc*ss-4*xm^2*ym*yy*cc*ss-20*xx^2*ym*yy*cc*ss+4*a*xm*xx*ym^3*...
             cx*cy2*sx+16*a*xm*xx^3*ym*cx*cy2*sx+4*a*xm^3*xx*ym*cx*cy2*sx-...
             4*a*xm*xx*yy^3*cx*cy2*sx-16*a*xm*xx^3*yy*cx*cy2*sx-4*a*xm^3*...
             xx*yy*cx*cy2*sx-8*a*xx^3*ym*yy*cx2*cy*sy-4*a*xm*xx*ym^3*cx*sx*...
             sy2-16*a*xm*xx^3*ym*cx*sx*sy2-4*a*xm^3*xx*ym*cx*sx*sy2+4*a*xm*...
             xx*yy^3*cx*sx*sy2+16*a*xm*xx^3*yy*cx*sx*sy2+4*a*xm^3*xx*yy*cx*...
             sx*sy2+16*a*xx*ym*yy^3*cy*sx2*sy+16*a*xx*ym^3*yy*cy*sx2*sy+32*...
             a*xx^3*ym*yy*cy*sx2*sy+12*a*xm*xx*ym*yy^2*cx*cy2*sx-12*a*xm*xx*...
             ym^2*yy*cx*cy2*sx+8*a*xm*xx^2*ym*yy*cx2*cy*sy-4*a*xm^2*xx*ym*...
             yy*cx2*cy*sy-12*a*xm*xx*ym*yy^2*cx*sx*sy2+12*a*xm*xx*ym^2*yy*...
             cx*sx*sy2-24*a*xm*xx^2*ym*yy*cy*sx2*sy+12*a*xm^2*xx*ym*yy*cy*...
             sx2*sy+12*xm*xx*ym*yy*cc*ss))/(xx*(xm^2-2*ym*yy-2*xm*xx+2*xx^2+...
             ym^2+yy^2)^2)-(3^(1/2)*(ss+2)^2*(2*cx*sy-cx2*cy2+2*cy*sx+20))/...
             (2*tie*(cy*sx-10)*(-(2*cy*sx-20)/Mref)^(1/2))+(5*a*cx*sy*(cy*sx-10)*...
             (ss+2)*(xm-xx))/(3*xx*((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/...
             xx^2)^(1/2))+(5*a*cc*sx*(xm-xx)*(10*cy+sx+2*sy-2*cy2*sx))/(3*xx*...
             ((xm^2-2*ym*yy-2*xm*xx+2*xx^2+ym^2+yy^2)/xx^2)^(1/2))-(5*cc*(cy*...
             sx-10)*(2*ym-2*yy)*(ss+2)*(xm-xx))/(6*xx^3*((xm^2-2*ym*yy-2*xm*...
             xx+2*xx^2+ym^2+yy^2)/xx^2)^(3/2));
        
        
  
    end
end