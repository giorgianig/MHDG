function f = bodyForce3d(X,t)

global testcase kT Mesh diff_n diff_u Magnetic  axisym theta coeffconv


N2d = size(X,1);
N1d = size(t,1);




% allocation
f = zeros(N2d*N1d,2);

% assign
x = X(:,1);
y = X(:,2);

xmax = Mesh.maxx;
xmin = Mesh.minx;
ymax = Mesh.maxy;
ymin = Mesh.miny;
xm = 0.5*(xmax+xmin);
ym = 0.5*(ymax+ymin);
xc = testcase.xc;
yc = testcase.yc;
% xm = xc;
% ym = yc;

k = kT;
D = diff_n;
mu = diff_u;
a = testcase.wavex;
a = 2*pi*a;
b = testcase.wavey;
b = 2*pi*b;

for i=1:N2d
    for j=1:N1d
        xx = x(i);
        yy = y(i);
        tt = t(j);
        r = sqrt((xx-xm)^2+(yy-ym)^2);
        ind = (j-1)*N2d+i;
        
        switch testcase.n
            case 1
                %% Cartesian case, circular field centered in [xm, ym] in the poloidal plane, Bt = 1
                t1 = cos(a*xx)*cos(a*yy);
                t2 = sin(a*xx)*sin(a*yy);
                t3 = cos(a*xx)*sin(a*yy);
                t4 = cos(a* yy)*sin(a* xx);
                t5 = cos(a* yy)*sin(a* yy);
                t8 = cos(a*xx)^2* cos(a*yy)^2;
                ta = (xm^2-2*ym*yy-2*xm*xx +xx^2+ym^2+yy^2+1);
                f(ind,1) = (2*D*a^2*sin(a*xx)*sin(a*yy) - 2*a*xm*cos(a*xx)*sin(a*yy)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) + 2*a*xx*cos(a*xx)*sin(a*yy)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) + 2*a*ym*cos(a*yy)*sin(a*xx)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) - 2*a*yy*cos(a*yy)*sin(a*xx)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) + D*a^2*xm^2*sin(a*xx)*sin(a*yy) + D*a^2*xx^2*sin(a*xx)*sin(a*yy) + D*a^2*ym^2*sin(a*xx)*sin(a*yy) + D*a^2*yy^2*sin(a*xx)*sin(a*yy) + D*a*xm*cos(a*xx)*sin(a*yy) - D*a*xx*cos(a*xx)*sin(a*yy) + D*a*ym*cos(a*yy)*sin(a*xx) - D*a*yy*cos(a*yy)*sin(a*xx) + a*xm*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) - a*xx*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) - a*ym*cos(a*xx)^2*cos(a*yy)*sin(a*yy)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) + a*yy*cos(a*xx)^2*cos(a*yy)*sin(a*yy)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) - a*xm*cos(a*xx)*sin(a*xx)*sin(a*yy)^2*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) + a*xx*cos(a*xx)*sin(a*xx)*sin(a*yy)^2*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) + a*ym*cos(a*yy)*sin(a*xx)^2*sin(a*yy)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) - a*yy*cos(a*yy)*sin(a*xx)^2*sin(a*yy)*((xm - xx)^2 + (ym - yy)^2 + 1)^(1/2) - 2*D*a^2*xm*ym*cos(a*xx)*cos(a*yy) + 2*D*a^2*xx*ym*cos(a*xx)*cos(a*yy) + 2*D*a^2*xm*yy*cos(a*xx)*cos(a*yy) - 2*D*a^2*xx*yy*cos(a*xx)*cos(a*yy) - 2*D*a^2*xm*xx*sin(a*xx)*sin(a*yy) - 2*D*a^2*ym*yy*sin(a*xx)*sin(a*yy))/((xm - xx)^2 + (ym - yy)^2 + 1);
                f(ind,2) = ((a*mu*xx*sin(2*a*yy))/2 - (a*mu*xm*sin(2*a*yy))/2 - (a*mu*ym*sin(2*a*xx))/2 + (a*mu*yy*sin(2*a*xx))/2 - 2*a^2*mu*xm*ym + 2*a^2*mu*xx*ym + 2*a^2*mu*xm*yy - 2*a^2*mu*xx*yy + 4*a^2*mu*cos(a*xx)*cos(a*yy) + 4*a^2*mu*xm*ym*cos(a*xx)^2 - 4*a^2*mu*xx*ym*cos(a*xx)^2 - 4*a^2*mu*xm*yy*cos(a*xx)^2 + 4*a^2*mu*xx*yy*cos(a*xx)^2 + 4*a^2*mu*xm*ym*cos(a*yy)^2 - 4*a^2*mu*xx*ym*cos(a*yy)^2 - 4*a^2*mu*xm*yy*cos(a*yy)^2 + 4*a^2*mu*xx*yy*cos(a*yy)^2 + 2*a^2*mu*xm^2*cos(a*xx)*cos(a*yy) + 2*a^2*mu*xx^2*cos(a*xx)*cos(a*yy) + 2*a^2*mu*ym^2*cos(a*xx)*cos(a*yy) + 2*a^2*mu*yy^2*cos(a*xx)*cos(a*yy) - 2*a*mu*xm*cos(a*yy)*sin(a*xx) + 2*a*mu*xx*cos(a*yy)*sin(a*xx) - 2*a*mu*ym*cos(a*xx)*sin(a*yy) + 2*a*mu*yy*cos(a*xx)*sin(a*yy) + 8*a^2*mu*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy) - 2*a*xm*cos(a*xx)^2*cos(a*yy)*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + 2*a*xx*cos(a*xx)^2*cos(a*yy)*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + 4*a*ym*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 4*a*xm*cos(a*xx)^2*cos(a*yy)*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + 4*a*xx*cos(a*xx)^2*cos(a*yy)*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 4*a*yy*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + 2*a*ym*cos(a*xx)*cos(a*yy)^2*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 2*a*yy*cos(a*xx)*cos(a*yy)^2*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 8*a^2*mu*xm*ym*cos(a*xx)^2*cos(a*yy)^2 + 8*a^2*mu*xx*ym*cos(a*xx)^2*cos(a*yy)^2 + 8*a^2*mu*xm*yy*cos(a*xx)^2*cos(a*yy)^2 - 8*a^2*mu*xx*yy*cos(a*xx)^2*cos(a*yy)^2 + 3*a*xm*cos(a*xx)^2*cos(a*yy)^3*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 3*a*xx*cos(a*xx)^2*cos(a*yy)^3*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 3*a*ym*cos(a*xx)^3*cos(a*yy)^2*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + 3*a*yy*cos(a*xx)^3*cos(a*yy)^2*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + a*k*xm*cos(a*yy)*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - a*k*xx*cos(a*yy)*sin(a*xx)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - a*k*ym*cos(a*xx)*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) + a*k*yy*cos(a*xx)*sin(a*yy)*(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1)^(1/2) - 4*a^2*mu*xm*xx*cos(a*xx)*cos(a*yy) - 4*a^2*mu*ym*yy*cos(a*xx)*cos(a*yy) - 4*a^2*mu*xm*ym*sin(a*xx)*sin(a*yy) + 4*a^2*mu*xx*ym*sin(a*xx)*sin(a*yy) + 4*a^2*mu*xm*yy*sin(a*xx)*sin(a*yy) - 4*a^2*mu*xx*yy*sin(a*xx)*sin(a*yy) + 2*a*mu*ym*cos(a*xx)*cos(a*yy)^2*sin(a*xx) + 2*a*mu*xm*cos(a*xx)^2*cos(a*yy)*sin(a*yy) - 2*a*mu*xx*cos(a*xx)^2*cos(a*yy)*sin(a*yy) - 2*a*mu*yy*cos(a*xx)*cos(a*yy)^2*sin(a*xx) + 4*a^2*mu*xm^2*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy) + 4*a^2*mu*xx^2*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy) + 4*a^2*mu*ym^2*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy) + 4*a^2*mu*yy^2*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy) - 8*a^2*mu*xm*xx*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy) - 8*a^2*mu*ym*yy*cos(a*xx)*cos(a*yy)*sin(a*xx)*sin(a*yy))/(xm^2 - 2*ym*yy - 2*xm*xx + xx^2 + ym^2 + yy^2 + 1);
                %             f(ind,1) = (2*D*a^2*t2-2*a*xm*t3*((xm-xx)^2+(ym-yy)^2+1)^(0.5)+2*a*xx*t3*((xm-xx)^2+(ym-yy)^2+1)^(0.5)+2*a*ym*t4*((xm-xx)^2+(ym-yy)^2+1)^(0.5)-...
                %                 2*a*yy*t4*((xm-xx)^2+(ym-yy)^2+1)^(0.5)+D*a^2*xm^2*t2+D*a^2*xx^2*t2+D*a^2*ym^2*t2+D*a^2*yy^2*t2+D*a*xm*t3-D*a*xx*t3+D*a*ym*t4-D*a*yy*t4+a*...
                %                 xm*t1^2*sin(a*xx)*((xm-xx)^2+(ym-yy)^2+1)^(0.5)-a*xx*t1^2*sin(a*xx)*((xm-xx)^2+(ym-yy)^2+1)^(0.5)-a*ym*cos(a*xx)^2*t5*((xm-xx)^2+(ym-yy)^2+1)...
                %                 ^(0.5)+a*yy*cos(a*xx)^2*t5*((xm-xx)^2+(ym-yy)^2+1)^(0.5)-a*xm*cos(a*xx)*t2^2*((xm-xx)^2+(ym-yy)^2+1)^(0.5)+a*xx*cos(a*xx)*t2^2*((xm-xx)^2+...
                %                 (ym-yy)^2+1)^(0.5)+a*ym*t4^2*sin(a*yy)*((xm-xx)^2+(ym-yy)^2+1)^(0.5)-a*yy*t4^2*sin(a*yy)*((xm-xx)^2+(ym-yy)^2+1)^(0.5)-2*D*a^2*xm*ym*t1+...
                %                 2*D*a^2*xx*ym*t1+2*D*a^2*xm*yy*t1-2*D*a^2*xx*yy*t1-2*D*a^2*xm*xx*t2-2*D*a^2*ym*yy*t2)/((xm-xx)^2+(ym-yy)^2+1);
                %             f(ind,2) = ((a*mu*xx*sin(2*a*yy))/2-(a*mu*xm*sin(2*a*yy))/2-(a*mu*ym*sin(2*a*xx))/2+(a*mu*yy*sin(2*a*xx))/2-2*a^2*mu*xm*ym+2*a^2*mu*xx*ym+...
                %                 2*a^2*mu*xm*yy-2*a^2*mu*xx*yy+4*a^2*mu*t1+4*a^2*mu*xm*ym*cos(a*xx)^2-4*a^2*mu*xx*ym*cos(a*xx)^2-4*a^2*mu*xm*yy*cos(a*xx)^2+4*a^2*mu*xx*...
                %                 yy*cos(a*xx)^2+4*a^2*mu*xm*ym*cos(a*yy)^2-4*a^2*mu*xx*ym*cos(a*yy)^2-4*a^2*mu*xm*yy*cos(a*yy)^2+4*a^2*mu*xx*yy*cos(a*yy)^2+2*a^2*mu*xm^2*...
                %                 t1+2*a^2*mu*xx^2*t1+2*a^2*mu*ym^2*t1+2*a^2*mu*yy^2*t1-2*a*mu*xm*t4+2*a*mu*xx*t4-2*a*mu*ym*t3+2*a*mu*yy*t3+8*a^2*mu*t1*t2-2*a*xm*cos(a*xx)^2*...
                %                 t4*ta^(0.5)+2*a*xx*cos(a*xx)^2*t4*ta^(0.5)+4*a*ym*t1^2*sin(a*xx)*ta^(0.5)-4*a*xm*cos(a*xx)^2*t5*ta^(0.5)+4*a*xx*cos(a*xx)^2*t5*ta^(0.5)-4*...
                %                 a*yy*t1^2*sin(a*xx)*ta^(0.5)+2*a*ym*t1^2*sin(a*yy)*ta^(0.5)-2*a*yy*t1^2*sin(a*yy)*ta^(0.5)-8*a^2*mu*xm*ym*t8+8*a^2*mu*xx*ym*t8+8*a^2*mu*xm*yy*...
                %                 t8-8*a^2*mu*xx*yy*t8+3*a*xm*cos(a*xx)^2*cos(a*yy)^3*sin(a*xx)*ta^(0.5)-3*a*xx*cos(a*xx)^2*cos(a*yy)^3*sin(a*xx)*ta^(0.5)-3*a*ym*cos(a*xx)^3*...
                %                 cos(a*yy)^2*sin(a*yy)*ta^(0.5)+3*a*yy*cos(a*xx)^3*cos(a*yy)^2*sin(a*yy)*ta^(0.5)+a*k*xm*t4*ta^(0.5)-a*k*xx*t4*ta^(0.5)-a*k*ym*t3*ta^(0.5)+a*k*...
                %                 yy*t3*ta^(0.5)-4*a^2*mu*xm*xx*t1-4*a^2*mu*ym*yy*t1-4*a^2*mu*xm*ym*t2+4*a^2*mu*xx*ym*t2+4*a^2*mu*xm*yy*t2-4*a^2*mu*xx*yy*t2+2*a*mu*ym*t1^2*...
                %                 sin(a*xx)+2*a*mu*xm*cos(a*xx)^2*t5-2*a*mu*xx*cos(a*xx)^2*t5-2*a*mu*yy*t1^2*sin(a*xx)+4*a^2*mu*xm^2*t1*t2+4*a^2*mu*xx^2*t1*t2+4*a^2*mu*ym^2*...
                %                 t1*t2+4*a^2*mu*yy^2*t1*t2-8*a^2*mu*xm*xx*t1*t2-8*a^2*mu*ym*yy*t1*t2)/ta;
            case 2
                %% ! Axisimmetric case with div(b)~=0,circular field centered in [xm, ym] in the poloidal plane, Bt = 1
                cx =  cos(a*xx);
                cy =  cos(a*yy);
                sx = sin(a*xx);
                sy = sin(a*yy);
                cx2 = cx^2;
                cy2 = cy^2;

                t1 = cos(a*xx)*cos(a*yy);
                t2 = sin(a*xx)*sin(a*yy);
                t3 = cos(a*xx)*sin(a*yy);
                t4 = cos(a*yy)*sin(a*xx);                
                t5 = ((xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2);
                t6 = ((xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(3/2);
                f(ind,1) = (2*a*xx^5*t3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) - 6*D*a*xx^4*t3 -...
                    D*a*xm^4*t3 - 2*xx*ym^3*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - ...
                    2*xx^3*ym*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + 2*xx*yy^3*t1*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(1/2) + 2*xx^3*yy*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + ...
                    6*D*a^2*xx^5*t2 - 10*D*a^2*xm*xx^4*t2 + D*a^2*xm^4*xx*t2 + D*a^2*xx*ym^4*t2 + D*a^2*xx*yy^4*t2 - ...
                    a*xx^5*t1^2*sx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) + a*xx^5*cx*t2^2*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(3/2) + 2*D*a^2*xx^2*ym^3*t1 - 2*D*a^2*xx^2*yy^3*t1 + 9*D*a^2*xm^2*xx^3*t2 - ...
                    4*D*a^2*xm^3*xx^2*t2 + 5*D*a^2*xx^3*ym^2*t2 + 5*D*a^2*xx^3*yy^2*t2 + 12*D*a*xm*xx^3*t3 + 5*D*a*xm^3*xx*t3 - ...
                    D*a*xm*ym^3*t4 - D*a*xm^3*ym*t4 + 2*D*a*xx*ym^3*t4 + 2*D*a*xx^3*ym*t4 + D*a*xm*yy^3*t4 + D*a*xm^3*yy*t4 -...
                    2*D*a*xx*yy^3*t4 - 2*D*a*xx^3*yy*t4 - 2*a*xm*xx^4*t3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) + ...
                    2*a*xx^4*ym*t4*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) - 2*a*xx^4*yy*t4*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(3/2) + 4*xm*xx^2*ym*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - ...
                    2*xm^2*xx*ym*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - 4*xm*xx^2*yy*t1*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(1/2) + 2*xm^2*xx*yy*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - ...
                    6*xx*ym*yy^2*t1*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + 6*xx*ym^2*yy*t1*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(1/2) + 4*D*a^2*xx^4*ym*t1 - 4*D*a^2*xx^4*yy*t1 - 11*D*a*xm^2*xx^2*t3 - D*a*xm^2*ym^2*t3 - ...
                    5*D*a*xx^2*ym^2*t3 - D*a*xm^2*yy^2*t3 - 5*D*a*xx^2*yy^2*t3 + 3*D*a*xm*xx*ym^2*t3 - 4*D*a*xm*xx^2*ym*t4 + ...
                    4*D*a*xm^2*xx*ym*t4 + 3*D*a*xm*xx*yy^2*t3 + 4*D*a*xm*xx^2*yy*t4 - 4*D*a*xm^2*xx*yy*t4 - 3*D*a*xm*ym*yy^2*t4 +...
                    3*D*a*xm*ym^2*yy*t4 + 2*D*a*xm^2*ym*yy*t3 + 6*D*a*xx*ym*yy^2*t4 - 6*D*a*xx*ym^2*yy*t4 + 10*D*a*xx^2*ym*yy*t3 - ...
                    2*D*a^2*xm*xx*ym^3*t1 - 8*D*a^2*xm*xx^3*ym*t1 - 2*D*a^2*xm^3*xx*ym*t1 + 2*D*a^2*xm*xx*yy^3*t1 + 8*D*a^2*xm*xx^3*yy*t1 + ...
                    2*D*a^2*xm^3*xx*yy*t1 - 4*D*a^2*xx*ym*yy^3*t2 - 4*D*a^2*xx*ym^3*yy*t2 - 10*D*a^2*xx^3*ym*yy*t2 - ...
                    xx*ym^3*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - xx^3*ym*t1*t2*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(1/2) + xx*yy^3*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + ...
                    xx^3*yy*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + a*xm*xx^4*t1^2*sx*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(3/2) - a*xx^4*ym*cx2*cy*sy*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) + ...
                    a*xx^4*yy*cx2*cy*sy*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) - a*xm*xx^4*cx*t2^2*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(3/2) + a*xx^4*ym*t4^2*sy*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) - ...
                    a*xx^4*yy*t4^2*sy*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2) + 6*D*a^2*xm^2*xx^2*ym*t1 - ...
                    6*D*a^2*xm^2*xx^2*yy*t1 + 6*D*a^2*xx^2*ym*yy^2*t1 - 6*D*a^2*xx^2*ym^2*yy*t1 - 4*D*a^2*xm*xx^2*ym^2*t2 + ...
                    2*D*a^2*xm^2*xx*ym^2*t2 - 4*D*a^2*xm*xx^2*yy^2*t2 + 2*D*a^2*xm^2*xx*yy^2*t2 + 6*D*a^2*xx*ym^2*yy^2*t2 + ...
                    8*D*a^2*xm*xx^2*ym*yy*t2 - 4*D*a^2*xm^2*xx*ym*yy*t2 + 2*xm*xx^2*ym*t1*t2*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(1/2) - xm^2*xx*ym*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - ...
                    2*xm*xx^2*yy*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + xm^2*xx*yy*t1*t2*((xm - xx)^2/xx^2 + ...
                    (ym - yy)^2/xx^2 + 1)^(1/2) - 3*xx*ym*yy^2*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) + ...
                    3*xx*ym^2*yy*t1*t2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - 6*D*a*xm*xx*ym*yy*t3 -...
                    6*D*a^2*xm*xx*ym*yy^2*t1 + 6*D*a^2*xm*xx*ym^2*yy*t1)/(xx*(xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)^2);
                
                
                
                
                
                
                f(ind,2) =  (2*a^2*mu*xx^2*ym^3 - 2*a^2*mu*xx^2*yy^3 + (a*mu*xm^4*sin(2*a*yy))/2 + 3*a*mu*xx^4*sin(2*a*yy) + 4*a^2*mu*xx^4*ym - 4*a^2*mu*xx^4*yy...
                    - 2*xx*ym^3*cx2*cy2*t5 - 2*xx^3*ym*cx2*cy2*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) + 2*xx*yy^3*cx2*cos(a*yy)^2*t5 + ...
                    2*xx^3*yy*cx2*cy2*((xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2+ yy^2)/xx^2)^(1/2) + ...
                    (a*mu*xm*ym^3*sin(2*a*xx))/2 + (a*mu*xm^3*ym*sin(2*a*xx))/2 - a*mu*xx*ym^3*sin(2*a*xx) - ...
                    a*mu*xx^3*ym*sin(2*a*xx) - 6*a*mu*xm*xx^3*sin(2*a*yy) - (a*mu*xm*yy^3*sin(2*a*xx))/2 - ...
                    (5*a*mu*xm^3*xx*sin(2*a*yy))/2 - (a*mu*xm^3*yy*sin(2*a*xx))/2 + a*mu*xx*yy^3*sin(2*a*xx) + ...
                    a*mu*xx^3*yy*sin(2*a*xx) - 4*a^2*mu*xx^2*ym^3*cx2 + 4*a^2*mu*xx^2*yy^3*cos(a*xx)^2 - ...
                    4*a^2*mu*xx^2*ym^3*cy2 + 4*a^2*mu*xx^2*yy^3*cy2 + 2*a*mu*xm^4*t4 + 12*a*mu*xx^4*t4 - ...
                    2*a^2*mu*xm*xx*ym^3 - 8*a^2*mu*xm*xx^3*ym - 2*a^2*mu*xm^3*xx*ym + 2*a^2*mu*xm*xx*yy^3 + ...
                    8*a^2*mu*xm*xx^3*yy + 2*a^2*mu*xm^3*xx*yy + (11*a*mu*xm^2*xx^2*sin(2*a*yy))/2 + ...
                    (a*mu*xm^2*ym^2*sin(2*a*yy))/2 + (5*a*mu*xx^2*ym^2*sin(2*a*yy))/2 + (a*mu*xm^2*yy^2*sin(2*a*yy))/2 + ...
                    (5*a*mu*xx^2*yy^2*sin(2*a*yy))/2 + 12*a^2*mu*xx^5*t1 + 6*a^2*mu*xm^2*xx^2*ym - 6*a^2*mu*xm^2*xx^2*yy + ...
                    6*a^2*mu*xx^2*ym*yy^2 - 6*a^2*mu*xx^2*ym^2*yy- 8*a^2*mu*xx^4*ym*cx2 + 8*a^2*mu*xx^4*yy*cx2 - ...
                    8*a^2*mu*xx^4*ym*cy2 + 8*a^2*mu*xx^4*yy*cy2 - 20*a^2*mu*xm*xx^4*t1 + 2*a^2*mu*xm^4*xx*t1 + ...
                    2*a^2*mu*xx*ym^4*t1 + 2*a^2*mu*xx*yy^4*t1 + 22*a*mu*xm^2*xx^2*t4 + 2*a*mu*xm^2*ym^2*t4 +...
                    10*a*mu*xx^2*ym^2*t4 + 2*a*mu*xm^2*yy^2*t4 + 10*a*mu*xx^2*yy^2*t4 + 8*a^2*mu*xx^2*ym^3*cx2*cy2 - ...
                    8*a^2*mu*xx^2*yy^3*cx2*cy2 + 2*a*xx^5*cx2*t4*((xm^2 -2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(3/2) + ...
                    8*a^2*mu*xx^4*ym*t2- 8*a^2*mu*xx^4*yy*t2 + 4*a*xx^5*cx2*cy*sy*((xm^2 - 2*ym*yy - 2*xm*xx + ...
                    2*xx^2 + ym^2 + yy^2)/xx^2)^(3/2) - 2*a*mu*xm^4*cos(a*xx)^2*cy*sy - 12*a*mu*xx^4*cx2*cy*sy + ...
                    4*a^2*mu*xm*xx*ym^3*cx2 + 16*a^2*mu*xm*xx^3*ym*cx2 + 4*a^2*mu*xm^3*xx*ym*cx2 - 4*a^2*mu*xm*xx*yy^3*cx2 - ...
                    16*a^2*mu*xm*xx^3*yy*cx2 - 4*a^2*mu*xm^3*xx*yy*cx2 + 4*a^2*mu*xm*xx*ym^3*cos(a*yy)^2 + ...
                    16*a^2*mu*xm*xx^3*ym*cy2 + 4*a^2*mu*xm^3*xx*ym*cos(a*yy)^2 - 4*a^2*mu*xm*xx*yy^3*cy2 - 16*a^2*mu*xm*xx^3*yy*cy2 - ...
                    4*a^2*mu*xm^3*xx*yy*cy2 + 18*a^2*mu*xm^2*xx^3*t1 - 8*a^2*mu*xm^3*xx^2*t1 + 10*a^2*mu*xx^3*ym^2*t1 + ...
                    10*a^2*mu*xx^3*yy^2*t1 + 4*xm*xx^2*ym*cos(a*xx)^2*cy2*t5 - ...
                    2*xm^2*xx*ym*cx2*cy2*t5 - 4*xm*xx^2*yy*cx2*cy2*t5 + 2*xm^2*xx*yy*cx2*cy2*t5 - ...
                    6*xx*ym*yy^2*cx2*cy2*t5 + 6*xx*ym^2*yy*cx2*cos(a*yy)^2*t5 - ...
                    3*a*xx^5*cx2*cy^3*sx*t6 + 4*a^2*mu*xx^2*ym^3*t2 - 4*a^2*mu*xx^2*yy^3*t2 + 2*a*mu*xm*xx^2*ym*sin(2*a*xx) - 2*a*mu*xm^2*xx*ym*sin(2*a*xx) - ...
                    2*a*mu*xm*xx^2*yy*sin(2*a*xx) + 2*a*mu*xm^2*xx*yy*sin(2*a*xx) - (3*a*mu*xm*xx*ym^2*sin(2*a*yy))/2 + ...
                    (3*a*mu*xm*ym*yy^2*sin(2*a*xx))/2 - (3*a*mu*xm*ym^2*yy*sin(2*a*xx))/2 - 3*a*mu*xx*ym*yy^2*sin(2*a*xx) + ...
                    3*a*mu*xx*ym^2*yy*sin(2*a*xx) - (3*a*mu*xm*xx*yy^2*sin(2*a*yy))/2 - a*mu*xm^2*ym*yy*sin(2*a*yy) - ...
                    5*a*mu*xx^2*ym*yy*sin(2*a*yy) - a*k*xx^5*t4*t6 - 12*a^2*mu*xm^2*xx^2*ym*cx2 + 12*a^2*mu*xm^2*xx^2*yy*cx2 - 12*a^2*mu*xm^2*xx^2*ym*cy2 - ...
                    12*a^2*mu*xx^2*ym*yy^2*cx2 + 12*a^2*mu*xx^2*ym^2*yy*cx2 + 12*a^2*mu*xm^2*xx^2*yy*cy2 - ...
                    12*a^2*mu*xx^2*ym*yy^2*cy2 + 12*a^2*mu*xx^2*ym^2*yy*cy2 - 24*a*mu*xm*xx^3*t4 - 10*a*mu*xm^3*xx*t4 + ...
                    2*a*mu*xm*ym^3*t3 + 2*a*mu*xm^3*ym*t3 - 4*a*mu*xx*ym^3*t3 - 4*a*mu*xx^3*ym*t3 - ...
                    2*a*mu*xm*yy^3*t3 - 2*a*mu*xm^3*yy*t3 + 4*a*mu*xx*yy^3*t3 + 4*a*mu*xx^3*yy*t3 - ...
                    6*a^2*mu*xm*xx*ym*yy^2 + 6*a^2*mu*xm*xx*ym^2*yy + 16*a^2*mu*xx^4*ym*cx^2*cy2 - 16*a^2*mu*xx^4*yy*cx2*cy2 + ...
                    3*a*xm*xx^4*cos(a*xx)^2*cy^3*sx*t6 + 12*a^2*mu*xm^2*xx^2*ym*t2 - 12*a^2*mu*xm^2*xx^2*yy*t2+ 12*a^2*mu*xx^2*ym*yy^2*t2 - ...
                    12*a^2*mu*xx^2*ym^2*yy*t2 - 3*a*xx^4*ym*cos(a*xx)^3*cy2*sy*((xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ...
                    ym^2 + yy^2)/xx^2)^(3/2) + 3*a*xx^4*yy*cx^3*cy2*sy*t6 + ...
                    a*k*xm*xx^4*t4*t6 - a*k*xx^4*ym*t3*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(3/2) + a*k*xx^4*yy*t3*((xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + ...
                    yy^2)/xx^2)^(3/2) - 22*a*mu*xm^2*xx^2*cx2*cy*sy - 2*a*mu*xm^2*ym^2*cx2*cy*sy - 10*a*mu*xx^2*ym^2*cx2*cy*sy - ...
                    2*a*mu*xm^2*yy^2*cx2*cy*sy - 10*a*mu*xx^2*yy^2*cos(a*xx)^2*cy*sy - 6*a*mu*xm*xx*ym^2*t4 + ...
                    8*a*mu*xm*xx^2*ym*t3 - 8*a*mu*xm^2*xx*ym*t3 - 6*a*mu*xm*xx*yy^2*t4 - 8*a*mu*xm*xx^2*yy*t3 + ...
                    8*a*mu*xm^2*xx*yy*t3 + 6*a*mu*xm*ym*yy^2*t3 - 6*a*mu*xm*ym^2*yy*t3 - 4*a*mu*xm^2*ym*yy*t4 - ...
                    12*a*mu*xx*ym*yy^2*t3 + 12*a*mu*xx*ym^2*yy*t3 - 20*a*mu*xx^2*ym*yy*t4 - 8*a^2*mu*xm*xx*ym^3*cx2*cy2 - ...
                    32*a^2*mu*xm*xx^3*ym*cos(a*xx)^2*cy2 - 8*a^2*mu*xm^3*xx*ym*cx2*cy2 + 8*a^2*mu*xm*xx*yy^3*cx2*cy2 + ...
                    32*a^2*mu*xm*xx^3*yy*cx2*cy2 + 8*a^2*mu*xm^3*xx*yy*cx2*cy2 - xx*ym^3*cos(a*xx)^2*cy2*t2*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) - xx^3*ym*cx2*cy2*t2*((xm^2 - 2*ym*yy - 2*xm*xx + ...
                    2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) + xx*yy^3*cx2*cy2*t2*((xm^2 - 2*ym*yy - 2*xm*xx + ...
                    2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) + xx^3*yy*cos(a*xx)^2*cy2*t2*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) - 8*a^2*mu*xx*ym*yy^3*t1 - 8*a^2*mu*xx*ym^3*yy*t1 - ...
                    20*a^2*mu*xx^3*ym*yy*t1 + 24*a^2*mu*xm^2*xx^2*ym*cx2*cy2 - 24*a^2*mu*xm^2*xx^2*yy*cx2*cy2 - ...
                    2*a*xm*xx^4*cx2*t4*t6 + 24*a^2*mu*xx^2*ym*yy^2*cos(a*xx)^2*cy2 - 24*a^2*mu*xx^2*ym^2*yy*cx2*cy2 - 4*a^2*mu*xm*xx*ym^3*t2 - ...
                    16*a^2*mu*xm*xx^3*ym*t2 - 4*a^2*mu*xm^3*xx*ym*t2 + 4*a^2*mu*xm*xx*yy^3*t2 + ...
                    16*a^2*mu*xm*xx^3*yy*t2 + 4*a^2*mu*xm^3*xx*yy*t2 +4*a*xx^4*ym*t1^2*sx*t6 - 4*a*xm*xx^4*cx2*cy*sy*t6 - ...
                    4*a*xx^4*yy*t1^2*sin(a*xx)*t6 + 2*a*xx^4*ym*t1^2*sy*t6 - 2*a*xx^4*yy*t1^2*sy*t6 + 3*a*mu*xm*xx*ym*yy*sin(2*a*yy) - 2*a*mu*xm*ym^3*t1^2*sx - ...
                    2*a*mu*xm^3*ym*t1^2*sx + 4*a*mu*xx*ym^3*t1^2*sin(a*xx) + 4*a*mu*xx^3*ym*t1^2*sx + ...
                    24*a*mu*xm*xx^3*cx2*cy*sy + 2*a*mu*xm*yy^3*t1^2*sx + 10*a*mu*xm^3*xx*cx2*cos(a*yy)*sy + ...
                    2*a*mu*xm^3*yy*t1^2*sx - 4*a*mu*xx*yy^3*t1^2*sin(a*xx) - 4*a*mu*xx^3*yy*t1^2*sx + ...
                    12*a^2*mu*xm*xx*ym*yy^2*cx^2 - 12*a^2*mu*xm*xx*ym^2*yy*cx2 + 12*a^2*mu*xm*xx*ym*yy^2*cy^2 - ...
                    12*a^2*mu*xm*xx*ym^2*yy*cy2 - 8*a^2*mu*xm*xx^2*ym^2*t1 + 4*a^2*mu*xm^2*xx*ym^2*t1 - ...
                    8*a^2*mu*xm*xx^2*yy^2*t1 + 4*a^2*mu*xm^2*xx*yy^2*t1 +12*a^2*mu*xx*ym^2*yy^2*t1 + ...
                    24*a^2*mu*xx^5*t1*t2 + 16*a^2*mu*xm*xx^2*ym*yy*t1 - 8*a^2*mu*xm^2*xx*ym*yy*t1 - ...
                    12*a^2*mu*xm*xx*ym*yy^2*t2 + 12*a^2*mu*xm*xx*ym^2*yy*t2 - 8*a*mu*xm*xx^2*ym*t1^2*sx + ...
                    8*a*mu*xm^2*xx*ym*t1^2*sin(a*xx) + 8*a*mu*xm*xx^2*yy*t1^2*sx - 8*a*mu*xm^2*xx*yy*t1^2*sin(a*xx) + ...
                    6*a*mu*xm*xx*ym^2*cx2*cy*sy - 6*a*mu*xm*ym*yy^2*t1^2*sx + 6*a*mu*xm*ym^2*yy*t1^2*sx + ...
                    12*a*mu*xx*ym*yy^2*t1^2*sx - 12*a*mu*xx*ym^2*yy*t1^2*sx + 6*a*mu*xm*xx*yy^2*cos(a*xx)^2*cy*sy + ...
                    4*a*mu*xm^2*ym*yy*cx2*cy*sin(a*yy) + 20*a*mu*xx^2*ym*yy*cx2*cy*sy + 12*a*mu*xm*xx*ym*yy*t4 - ...
                    40*a^2*mu*xm*xx^4*t1*t2 + 4*a^2*mu*xm^4*xx*t1*t2 + 4*a^2*mu*xx*ym^4*t1*t2 + 4*a^2*mu*xx*yy^4*t1*t2 -...
                    24*a^2*mu*xm*xx*ym*yy^2*cx2*cos(a*yy)^2 + 24*a^2*mu*xm*xx*ym^2*yy*cx2*cy2 + ...
                    36*a^2*mu*xm^2*xx^3*t1*t2 - 16*a^2*mu*xm^3*xx^2*t1*t2 + 20*a^2*mu*xx^3*ym^2*t1*t2 + ...
                    20*a^2*mu*xx^3*yy^2*t1*t2 + 2*xm*xx^2*ym*cx2*cy2*t2*((xm^2 - 2*ym*yy - 2*xm*xx + ...
                    2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) - xm^2*xx*ym*cx2*cos(a*yy)^2*t2*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2)- 2*xm*xx^2*yy*cx2*cy2*t2*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) + xm^2*xx*yy*cx2*cy2*t2*((xm^2 - 2*ym*yy - ...
                    2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) - 3*xx*ym*yy^2*cos(a*xx)^2*cy2*t2*((xm^2 - ...
                    2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) + 3*xx*ym^2*yy*cx2*cy2*t2*((xm^2 - ...
                    2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)/xx^2)^(1/2) - 16*a^2*mu*xm*xx^2*ym^2*t1*t2 +...
                    8*a^2*mu*xm^2*xx*ym^2*t1*t2 - 16*a^2*mu*xm*xx^2*yy^2*t1*t2 + 8*a^2*mu*xm^2*xx*yy^2*t1*t2 +...
                    24*a^2*mu*xx*ym^2*yy^2*t1*t2 - 12*a*mu*xm*xx*ym*yy*cos(a*xx)^2*cy*sy - 16*a^2*mu*xx*ym*yy^3*t1*t2 - ...
                    16*a^2*mu*xx*ym^3*yy*t1*t2 - 40*a^2*mu*xx^3*ym*yy*t1*t2 + 32*a^2*mu*xm*xx^2*ym*yy*t1*t2 - ...
                    16*a^2*mu*xm^2*xx*ym*yy*t1*t2)/(xx*(xm^2 - 2*ym*yy - 2*xm*xx + 2*xx^2 + ym^2 + yy^2)^2);
            case 3
                f(ind,1) = (2^(1/2)*(xx + 1))/2;
                f(ind,2) =  2^(1/2)*yy*(xx + 1);
            case 4
                f(ind,1) = 0;
                f(ind,2) = 0;
            case 5
                f(ind,1) = 0;
                f(ind,2) = 0;
            case 6
                f(ind,1) = 0;
                f(ind,2) = -6*mu*xx*(2*xx + 1);
            case 7
                f(ind,1) = (2^(1/2)*(xx^2 + yy^2))/2 + 2^(1/2)*yy*(xx + yy + 1);
                f(ind,2) = (2^(1/2)*k)/2 + (2^(1/2)*(xx^2 + yy^2)^2)/2 - mu*(7*xx + 5*yy + 3) + 2*2^(1/2)*yy*(xx^2 + yy^2)*(xx + yy + 1);
            case 8
                f(ind,1) = D*((xm - xx)/((xm - xx)^2 + (ym - yy)^2 + 1)+((2*xm - 2*xx)*(ym - yy)^2)/((xm - xx)^2 + (ym-yy)^2 + 1)^2-((2*ym-2*yy)*(xm-xx)*(ym-yy))/((xm-xx)^2 + (ym-yy)^2 + 1)^2)+((xm-xx)*(xx + 1))/((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-((ym-yy)*(yy + 1))/((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-((2*xm-2*xx)*(ym-yy)*(xx + 1)*(yy + 1))/(2*((xm-xx)^2 + (ym-yy)^2 + 1)^(3/2))+((2*ym-2*yy)*(xm-xx)*(xx + 1)*(yy + 1))/(2*((xm-xx)^2 + (ym-yy)^2 + 1)^(3/2));
                f(ind,2) = -(2*xx^2*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-2*yy^2*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-yy^3*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-mu*xm + mu*xx-mu*ym + mu*yy-2*xm*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + 2*xx*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + ym*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + k*ym*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-k*yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-2*xm*xx*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2)-2*xm*yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + 2*xx*yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + 2*ym*yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + 2*xx^2*yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + ym*yy^2*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2) + 2*mu*xm*ym-3*mu*xx*ym-3*mu*xm*yy + 4*mu*xx*yy-2*xm*xx*yy*((xm-xx)^2 + (ym-yy)^2 + 1)^(1/2))/((xm-xx)^2 + (ym-yy)^2 + 1);
            case 9
                f(ind,1) = (2^(1/2)*(xx + 1))/2;
                f(ind,2) = (2^(1/2)*(2*yy + 2)*(xx + 1))/2;
            case 10
                f(ind,1) = 0;
                f(ind,2) = 0;
            case 100
                uu = sin(b*tt)*sin(a*xx)*sin(a*yy);
                cc = cos(b*tt)*cos( a*xx)*cos(a*yy);
                ccs = cos(b*tt)*cos( a*xx)^2*sin(b*tt);
                cc1 = cos(a*xx)*cos( a*yy)*sin(b*tt);
                cc2 = cos(b*tt)^2*cos( a*yy)*sin(a*yy);
                cc3 = cos(b*tt)^2*cos(a*xx)*cos( a*yy)*sin(a*xx)*sin(a*yy);
                f(ind,1) = -(b^2*theta^2*uu+2*b*theta^2*cc1*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-b^2*theta^2*uu*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)-4*D*a*xm*pi^2*cos(a*xx)*sin(b*tt)*sin(a*yy)+4*D*a*xx*pi^2*cos(a*xx)*sin(b*tt)*sin(a*yy)-4*D*a*ym*pi^2*cos(a*yy)*sin(b*tt)*sin(a*xx)+4*D*a*yy*pi^2*cos(a*yy)*sin(b*tt)*sin(a*xx)-...
                    2*D*a^2*theta^2*uu*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)+4*D*a^2*xm^2*pi^2*uu+4*D*a^2*xx^2*pi^2*uu+4*D*a^2*ym^2*pi^2*uu+4*D*a^2*yy^2*pi^2*uu-8*D*a^2*xm*xx*pi^2*uu-8*D*a^2*ym*yy*pi^2*uu-2*a*b*theta*xm*pi*cos(b*tt)*cos(a*yy)*sin(a*xx)+2*a*b*theta*xx*pi*cos(b*tt)*cos(a*yy)*sin(a*xx)+2*a*b*theta*ym*pi*cos(b*tt)*cos(a*xx)*sin(a*yy)-...
                    2*a*b*theta*yy*pi*cos(b*tt)*cos(a*xx)*sin(a*yy)+4*a*theta*xm*pi*cos(b*tt)*cos(a*xx)*sin(a*yy)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-4*a*theta*xx*pi*cos(b*tt)*cos(a*xx)*sin(a*yy)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-4*a*theta*ym*pi*cos(b*tt)*cos(a*yy)*sin(a*xx)*((4*pi^2*(xm-xx)^2)/theta^2+...
                    (4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+4*a*theta*yy*pi*cos(b*tt)*cos(a*yy)*sin(a*xx)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-b*theta^2*cc3*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+b*theta^2*cc1^2*sin(a*xx)*sin(a*yy)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+8*D*a^2*xm*ym*pi^2*cc1-...
                    8*D*a^2*xx*ym*pi^2*cc1-8*D*a^2*xm*yy*pi^2*cc1+8*D*a^2*xx*yy*pi^2*cc1-2*D*a*b*theta*xm*pi*cos(b*tt)*cos(a*yy)*sin(a*xx)+2*D*a*b*theta*xx*pi*cos(b*tt)*cos(a*yy)*sin(a*xx)+2*D*a*b*theta*ym*pi*cos(b*tt)*cos(a*xx)*sin(a*yy)-2*D*a*b*theta*yy*pi*cos(b*tt)*cos(a*xx)*sin(a*yy)-2*a*theta*xm*pi*cc^2*sin(b*tt)*sin(a*xx)*((4*pi^2*(xm-xx)^2)/theta^2+...
                    (4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+2*a*theta*xx*pi*cc^2*sin(b*tt)*sin(a*xx)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+2*a*theta*ym*pi*cos(b*tt)*cos(a*xx)^2*cos(a*yy)*sin(b*tt)*sin(a*yy)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-2*a*theta*yy*pi*cos(b*tt)*cos(a*xx)^2*cos(a*yy)*sin(b*tt)*sin(a*yy)*...
                    ((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+2*a*theta*xm*pi*cos(b*tt)*cos(a*xx)*uu^2*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-2*a*theta*xx*pi*cos(b*tt)*cos(a*xx)*uu^2*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)-2*a*theta*ym*pi*cos(b*tt)*cos(a*yy)*sin(b*tt)*sin(a*xx)^2*sin(a*yy)*...
                    ((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2)+2*a*theta*yy*pi*cos(b*tt)*cos(a*yy)*sin(b*tt)*sin(a*xx)^2*sin(a*yy)*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2+1)^(1/2))/(theta^2*((4*pi^2*(xm-xx)^2)/theta^2+(4*pi^2*(ym-yy)^2)/theta^2)+theta^2);
                f(ind,2) = (a*b*theta*xm*pi*sin(2*a*xx)-a*b*theta*xx*pi*sin(2*a*xx)-a*b*theta*ym*pi*sin(2*a*yy)+a*b*theta*yy*pi*sin(2*a*yy)+4*a^2*mu*theta^2*cc+8*b^2*xm^2*pi^2*cc+8*b^2*xx^2*pi^2*cc+8*b^2*ym^2*pi^2*cc+8*b^2*yy^2*pi^2*cc-4*a^2*mu*xm*ym*pi^2*sin(2*b*tt)+4*a^2*mu*xx*ym*pi^2*sin(2*b*tt)+4*a^2*mu*xm*yy*pi^2*sin(2*b*tt)-4*a^2*mu*xx*yy*pi^2*sin(2*b*tt)-...
                    4*b*theta^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)^2*sin(b*tt)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-8*a*mu*xm*pi^2*cos(b*tt)*cos(a*yy)*sin(a*xx)+8*a*mu*xx*pi^2*cos(b*tt)*cos(a*yy)*sin(a*xx)-8*a*mu*ym*pi^2*cos(b*tt)*cos(a*xx)*sin(a*yy)+8*a*mu*yy*pi^2*cos(b*tt)*cos(a*xx)*sin(a*yy)+b*k*theta^2*...
                    cos(b*tt)*sin(a*xx)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+a*b*mu*theta*xm*pi*sin(2*a*xx)-a*b*mu*theta*xx*pi*sin(2*a*xx)-a*b*mu*theta*ym*pi*sin(2*a*yy)+a*b*mu*theta*yy*pi*sin(2*a*yy)-16*b^2*xm*xx*pi^2*cc-16*b^2*ym*yy*pi^2*cc+8*a^2*mu*xm^2*pi^2*cc+8*a^2*mu*xx^2*pi^2*cc+8*a^2*mu*ym^2*...
                    pi^2*cc+8*a^2*mu*yy^2*pi^2*cc-16*a^2*mu*xm*xx*pi^2*cc-16*a^2*mu*ym*yy*pi^2*cc-16*a^2*mu*xm*ym*pi^2*cos(b*tt)*sin(a*xx)*sin(a*yy)+16*a^2*mu*xx*ym*pi^2*cos(b*tt)*sin(a*xx)*sin(a*yy)+16*a^2*mu*xm*yy*pi^2*cos(b*tt)*sin(a*xx)*sin(a*yy)-16*a^2*mu*xx*yy*pi^2*cos(b*tt)*sin(a*xx)*sin(a*yy)+3*b*theta^2*cos(b*tt)^3*cos(a*xx)^2*cos(a*yy)^2*sin(a*xx)*sin(a*yy)*...
                    ((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+4*a*b*theta*xm*pi*cos(a*xx)*sin(b*tt)*sin(a*yy)-4*a*b*theta*xx*pi*cos(a*xx)*sin(b*tt)*sin(a*yy)-4*a*b*theta*ym*pi*cos(a*yy)*sin(b*tt)*sin(a*xx)+4*a*b*theta*yy*pi*cos(a*yy)*sin(b*tt)*sin(a*xx)+16*a^2*mu*xm*ym*pi^2*ccs-16*a^2*mu*xx*ym*pi^2*ccs-16*a^2*mu*xm*...
                    yy*pi^2*ccs+16*a^2*mu*xx*yy*pi^2*ccs+16*a^2*mu*xm*ym*pi^2*cos(b*tt)*cos(a*yy)^2*sin(b*tt)-...
                    16*a^2*mu*xx*ym*pi^2*cos(b*tt)*cos(a*yy)^2*sin(b*tt)-16*a^2*mu*xm*yy*pi^2*cos(b*tt)*cos(a*yy)^2*sin(b*tt)+16*a^2*mu*xx*yy*pi^2*cos(b*tt)*cos(a*yy)^2*sin(b*tt)-4*a*b*theta*xm*pi*cos(b*tt)^2*cos(a*xx)*sin(a*xx)+4*a*b*theta*xx*pi*cos(b*tt)^2*cos(a*xx)*sin(a*xx)+4*a*b*theta*ym*pi*cc2-4*a*b*theta*yy*pi*cc2-4*a*b*theta*xm*pi*cos(a*xx)*cos(a*yy)^2*sin(a*xx)+...
                    4*a*b*theta*xx*pi*cos(a*xx)*cos(a*yy)^2*sin(a*xx)+4*a*b*theta*ym*pi*cos(a*xx)^2*cos(a*yy)*sin(a*yy)-4*a*b*theta*yy*pi*cos(a*xx)^2*cos(a*yy)*sin(a*yy)-4*a*mu*ym*pi^2*cos(b*tt)*cos(a*xx)*sin(b*tt)*sin(a*xx)+4*a*mu*yy*pi^2*cos(b*tt)*cos(a*xx)*sin(b*tt)*sin(a*xx)-4*a*mu*xm*pi^2*cos(b*tt)*cos(a*yy)*sin(b*tt)*sin(a*yy)+4*a*mu*xx*pi^2*cos(b*tt)*cos(a*yy)*sin(b*tt)*sin(a*yy)-...
                    2*b*theta^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)^2*sin(a*xx)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-4*a*b*mu*theta*xm*pi*cos(b*tt)^2*cos(a*xx)*sin(a*xx)+4*a*b*mu*theta*xx*pi*cos(b*tt)^2*cos(a*xx)*sin(a*xx)+4*a*b*mu*theta*ym*pi*cc2-4*a*b*mu*theta*yy*pi*cc2-4*a*b*mu*theta*xm*pi*cos(a*xx)*cos(a*yy)^2*sin(a*xx)+...
                    4*a*b*mu*theta*xx*pi*cos(a*xx)*cos(a*yy)^2*sin(a*xx)+4*a*b*mu*theta*ym*pi*cos(a*xx)^2*cos(a*yy)*sin(a*yy)-4*a*b*mu*theta*yy*pi*cos(a*xx)^2*cos(a*yy)*sin(a*yy)+8*a^2*mu*theta^2*cc*uu-32*a^2*mu*xm*ym*pi^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)^2*sin(b*tt)+32*a^2*mu*xx*ym*pi^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)^2*sin(b*tt)+32*a^2*mu*xm*yy*pi^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)^2*sin(b*tt)-...
                    32*a^2*mu*xx*yy*pi^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)^2*sin(b*tt)+16*b^2*xm^2*pi^2*cc*uu+16*b^2*xx^2*pi^2*cc*uu+16*b^2*ym^2*pi^2*cc*uu+16*b^2*yy^2*pi^2*cc*uu+8*a*b*theta*xm*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(a*xx)-8*a*b*theta*xx*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(a*xx)-8*a*b*theta*ym*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)*sin(a*yy)+8*a*b*theta*yy*pi*cos(b*tt)^2*...
                    cos(a*xx)^2*cos(a*yy)*sin(a*yy)+8*a*theta*ym*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-8*a*theta*xm*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+8*a*theta*xx*pi*cos(b*tt)^2*...
                    cos(a*xx)^2*cos(a*yy)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-8*a*theta*yy*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+4*a*b*mu*theta*xm*pi*cos(a*xx)*sin(b*tt)*sin(a*yy)-4*a*b*mu*theta*xx*pi*cos(a*xx)*sin(b*tt)*...
                    sin(a*yy)-4*a*b*mu*theta*ym*pi*cos(a*yy)*sin(b*tt)*sin(a*xx)+4*a*b*mu*theta*yy*pi*cos(a*yy)*sin(b*tt)*sin(a*xx)+2*a*k*theta*xm*pi*cos(a*yy)*sin(b*tt)*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-2*a*k*theta*xx*pi*cos(a*yy)*sin(b*tt)*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-...
                    8*ym*yy*pi^2)/theta^2)^(1/2)-2*a*k*theta*ym*pi*cos(a*xx)*sin(b*tt)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+2*a*k*theta*yy*pi*cos(a*xx)*sin(b*tt)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+8*a*mu*ym*pi^2*cc^2*sin(b*tt)*sin(a*xx)+8*a*mu*xm*pi^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)*sin(b*tt)*sin(a*yy)-8*a*mu*xx*pi^2*cos(b*tt)*cos(a*xx)^2*cos(a*yy)*sin(b*tt)*sin(a*yy)-8*a*mu*yy*pi^2*cc^2*sin(b*tt)*sin(a*xx)+8*a*b*mu*theta*xm*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(a*xx)-8*a*b*mu*theta*xx*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(a*xx)-8*a*b*mu*theta*ym*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)*sin(a*yy)+8*a*b*mu*theta*yy*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)*sin(a*yy)-4*a*theta*xm*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)*sin(b*tt)*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+4*a*theta*xx*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)*sin(b*tt)*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+4*a*theta*ym*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(b*tt)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-4*a*theta*yy*pi*cos(b*tt)^2*cos(a*xx)*cos(a*yy)^2*sin(b*tt)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-32*b^2*xm*xx*pi^2*cc*uu-32*b^2*ym*yy*pi^2*cc*uu+6*a*theta*xm*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)^3*sin(b*tt)*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-6*a*theta*xx*pi*cos(b*tt)^2*cos(a*xx)^2*cos(a*yy)^3*sin(b*tt)*sin(a*xx)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)-6*a*theta*ym*pi*cos(b*tt)^2*cos(a*xx)^3*cos(a*yy)^2*sin(b*tt)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+6*a*theta*yy*pi*cos(b*tt)^2*cos(a*xx)^3*cos(a*yy)^2*sin(b*tt)*sin(a*yy)*((theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2)/theta^2)^(1/2)+16*a^2*mu*xm^2*pi^2*cc*uu+16*a^2*mu*xx^2*pi^2*cc*uu+16*a^2*mu*ym^2*pi^2*cc*uu+16*a^2*mu*yy^2*pi^2*cc*uu-32*a^2*mu*xm*xx*pi^2*cc*uu-32*a^2*mu*ym*yy*pi^2*cc*uu)/(theta^2+4*xm^2*pi^2+4*xx^2*pi^2+4*ym^2*pi^2+4*yy^2*pi^2-8*xm*xx*pi^2-8*ym*yy*pi^2);
            case 1000
                f(ind,1) = -(xm^2*ym + xx^2*ym - xm^2*yy - xx^2*yy + 3*ym*yy^2 - 3*ym^2*yy + ym^3 - yy^3 - 2*xm*xx*ym + 2*xm*xx*yy)/(xx^4*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2));
                f(ind,2) = -(xm^2*ym + xx^2*ym - xm^2*yy - xx^2*yy + 3*ym*yy^2 - 3*ym^2*yy + ym^3 - yy^3 - 2*xm*xx*ym + 2*xm*xx*yy)/(xx^4*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2));                                           
            case 1001
                f(ind,1) =1/(xx^4*(1/xx^2 + 1)^(3/2));
                f(ind,2) =1/(xx^4*(1/xx^2 + 1)^(3/2));
            case 1002
                % 0
            case 1003
                f(ind,1) =1/(xx^4*(1/xx^2)^(3/2));
                f(ind,2) =1/(xx^4*(1/xx^2)^(3/2));
            case 2000
                f(ind,1) =coeffconv*(((a*cos(a*yy)*sin(a*xx)*(ym - yy))/((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2) - (cos(a*xx)*cos(a*yy)*(ym - yy)*((2*xm - 2*xx)/xx^2 + (2*(xm - xx)^2)/xx^3 + (2*(ym - yy)^2)/xx^3))/(2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2)))/xx + (cos(a*xx)*cos(a*yy)*(2*ym - 2*yy)*(xm - xx))/(2*xx^3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2)) - (a*cos(a*xx)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2))); 
                f(ind,2) = mu*((xx*(a^2*cos(a*xx)*cos(a*yy) - ((ym - yy)*((a*cos(a*xx)*sin(a*yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (a^2*cos(a*xx)*cos(a*yy)*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (a^2*sin(a*xx)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (a*cos(a*xx)*sin(a*yy)*(xm - xx))/(xx^2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (a*cos(a*yy)*sin(a*xx)*(ym - yy))/(xx^2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (a*cos(a*xx)*sin(a*yy)*(xm - xx)*((2*xm - 2*xx)/xx^2 + (2*(xm - xx)^2)/xx^3 + (2*(ym - yy)^2)/xx^3))/(2*xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2)) + (a*cos(a*yy)*sin(a*xx)*(ym - yy)*((2*xm - 2*xx)/xx^2 + (2*(xm - xx)^2)/xx^3 + (2*(ym - yy)^2)/xx^3))/(2*xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2))))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (((a*cos(a*xx)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (a*cos(a*yy)*sin(a*xx)*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)))*(ym - yy))/(xx^2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (((a*cos(a*xx)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (a*cos(a*yy)*sin(a*xx)*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)))*(ym - yy)*((2*xm - 2*xx)/xx^2 + (2*(xm - xx)^2)/xx^3 + (2*(ym - yy)^2)/xx^3))/(2*xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2))) + a*cos(a*yy)*sin(a*xx) + (((a*cos(a*xx)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (a*cos(a*yy)*sin(a*xx)*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)))*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)))/xx + a^2*cos(a*xx)*cos(a*yy) - ((xm - xx)*((a*cos(a*yy)*sin(a*xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (a^2*cos(a*xx)*cos(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (a^2*sin(a*xx)*sin(a*yy)*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) + (a*cos(a*xx)*sin(a*yy)*(2*ym - 2*yy)*(xm - xx))/(2*xx^3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2)) - (a*cos(a*yy)*sin(a*xx)*(2*ym - 2*yy)*(ym - yy))/(2*xx^3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2))))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - ((2*ym - 2*yy)*((a*cos(a*xx)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)) - (a*cos(a*yy)*sin(a*xx)*(ym - yy))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)))*(xm - xx))/(2*xx^3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2))) - ...
                    coeffconv*(((cos(a*xx)^2*cos(a*yy)^2*(ym - yy)*((2*xm - 2*xx)/xx^2 + (2*(xm - xx)^2)/xx^3 + (2*(ym - yy)^2)/xx^3))/(2*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2)) - (2*a*cos(a*xx)*cos(a*yy)^2*sin(a*xx)*(ym - yy))/((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2))/xx - (cos(a*xx)^2*cos(a*yy)^2*(2*ym - 2*yy)*(xm - xx))/(2*xx^3*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(3/2)) + (2*a*cos(a*xx)^2*cos(a*yy)*sin(a*yy)*(xm - xx))/(xx*((xm - xx)^2/xx^2 + (ym - yy)^2/xx^2 + 1)^(1/2)));
                
        end
    end
end